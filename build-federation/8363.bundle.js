(self.webpackChunkciqo=self.webpackChunkciqo||[]).push([[8363,5671],{49134:function(){},38264:function(){},61221:function(e,t,n){"use strict";n.r(t);var r=n(92950),a=n.n(r),i=n(12181),o=n.n(i),c=(n(23912),n(38956)),s=n.n(c),l=n(45819),d=(0,n(76951).createBrowserHistory)(),u=n(52156),p=n(60260),h=n(61311),f=n(2721),m=n(67536),x=n(63931),g=n(5691),v=n.n(g),b=n(44093),I=n(34035),w=n(78057),j=n(90636),y=n(8189),C=n(17805),Z=n(22855),S=function(e){var t=e.title,n=e.classes,r=e.handleDrawerOpen,a=e.open,i="v0.0.19";return(0,Z.jsx)(w.AppBar,{position:"fixed",className:v()(n.appBar,(0,f.Z)({},n.appBarShift,a)),children:(0,Z.jsxs)(w.Toolbar,{children:[(0,Z.jsx)(w.IconButton,{color:"inherit","aria-label":"open drawer",onClick:r,edge:"start",className:v()(n.menuButton,(0,f.Z)({},n.hide,a)),children:(0,Z.jsx)(C.Z,{})}),(0,Z.jsx)(w.Typography,{variant:"h6",noWrap:!0,children:t}),(0,Z.jsxs)("div",{style:{position:"absolute",right:"10px"},children:[(0,Z.jsx)("a",{style:{color:"inherit",margin:"0 20px"},target:"_blank",children:"".concat(i)}),(0,Z.jsx)("a",{href:"https://documentation-ciqo.notion.site/documentation-ciqo/Doc-CIQO-f47d770ccf344ea6ae50119e58c82198",style:{color:"inherit",margin:"0 20px"},target:"_blank",children:"Documentation"}),(0,Z.jsx)("a",{href:"https://alliance-batiment.mydatbim.com/mydatbimCom/mentions-legales",style:{color:"inherit",margin:"0 20px"},target:"_blank",children:"Mentions l\xe9gales"}),(0,Z.jsx)("a",{href:"https://alliance-batiment.mydatbim.com/template/contact/387982",style:{color:"inherit",margin:"0 20px"},target:"_blank",children:"Contact"})]})]})})},k=240,E=(0,b.Z)((function(e){return{root:{display:"flex"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(k,"px)"),marginLeft:k,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:k,flexShrink:0},drawerPaper:{width:k},drawerHeader:(0,x.Z)((0,x.Z)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{flexGrow:1,transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}}}));function D(e){var t=e.title,n=e.menu,r=e.children,i=E(),o=(0,I.Z)(),c=a().useState(!1),s=(0,m.Z)(c,2),d=s[0],u=s[1];return(0,Z.jsxs)("div",{className:i.root,children:[(0,Z.jsx)(w.CssBaseline,{}),(0,Z.jsx)(S,{title:t,classes:i,handleDrawerOpen:function(){u(!0)},open:d}),(0,Z.jsxs)(w.Drawer,{className:i.drawer,variant:"persistent",anchor:"left",open:d,classes:{paper:i.drawerPaper},children:[(0,Z.jsx)("div",{className:i.drawerHeader,children:(0,Z.jsx)(w.IconButton,{onClick:function(){u(!1)},children:"ltr"===o.direction?(0,Z.jsx)(j.Z,{}):(0,Z.jsx)(y.Z,{})})}),(0,Z.jsx)(w.Divider,{}),(0,Z.jsx)(w.List,{children:n.MenuSideBarSup.map((function(e,t){return(0,Z.jsx)(l.Link,{to:e.link,style:{textDecoration:"none"},children:(0,Z.jsxs)(w.ListItem,{button:!0,children:[(0,Z.jsx)(w.ListItemIcon,{children:(0,Z.jsx)(w.Icon,{children:e.icon})}),(0,Z.jsx)(w.ListItemText,{primary:e.text})]},t)})}))}),(0,Z.jsx)(w.Divider,{}),(0,Z.jsx)(w.List,{children:n.MenuSideBarInf.map((function(e,t){return(0,Z.jsx)("a",{href:e.href,target:"_blank",style:{textDecoration:"none"},children:(0,Z.jsxs)(w.ListItem,{button:!0,children:[(0,Z.jsx)(w.ListItemIcon,{children:(0,Z.jsx)(w.Icon,{children:e.icon})}),(0,Z.jsx)(w.ListItemText,{primary:e.text})]},t)})}))})]}),(0,Z.jsxs)("main",{className:v()(i.content,(0,f.Z)({},i.contentShift,d)),children:[(0,Z.jsx)("div",{className:i.drawerHeader}),(0,Z.jsx)(w.Container,{maxWidth:"lg",className:i.container,children:r})]})]})}var T=n(39544),F=n(54288),P=n(43045),B=n(78041),A=n(12879),L=n(17433),N=n.n(L),M=n(23083),R=n(93017),_=n(79883),O=n(74713),G=n(59711),W=n(98671),z=n(61862),H=n(14873),V=n(47307),U=n(59221),Y=n(65100),X=n(38264),q=n.n(X),J=n(96703),Q=n(26259),K=n(30707),$=n(19866),ee=n(78750),te=n(91263),ne=(0,b.Z)({root:{maxWidth:345},media:{height:140}});function re(e){var t=e.open,n=e.onClose,a=e.onOpenViewpoint,i=(0,r.useState)(),o=(0,m.Z)(i,2),c=o[0],s=o[1],l=(0,r.useState)([]),d=(0,m.Z)(l,2),u=d[0],p=d[1],h=(0,r.useState)([]),f=(0,m.Z)(h,2),g=f[0],v=f[1];(0,r.useEffect)((function(){var e=u.filter((function(e){return e.viewpoints.length>0}));v(e)}),[]);var b=function(e){a(e),n()},I=(0,r.useCallback)(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new J.BcfReader,e.next=3,n.read(t[0]);case 3:console.log("SET TOPICS",n.topics),p(n.topics),s(t[0]),r=n.topics.filter((function(e){return e.viewpoints.length>0})),v(r),console.log("SET TOPICS",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),j=(0,L.useDropzone)({onDrop:I,accept:".bcf"}),y=j.getRootProps,C=j.getInputProps,S=j.isDragActive;return(0,Z.jsxs)(w.Dialog,{maxWidth:"xl",fullWidth:!0,disableBackdropClick:!0,open:t,onClose:n,children:[(0,Z.jsx)(w.DialogTitle,{children:"BCF Viewer"}),(0,Z.jsxs)(w.DialogContent,{children:[!c&&(0,Z.jsxs)(w.Box,(0,x.Z)((0,x.Z)({height:600,display:"flex",alignItems:"center",justifyContent:"center",border:S?"solid 4px":"none",borderColor:S?"#ffa50f":"",borderRadius:20},y()),{},{children:[(0,Z.jsx)("input",(0,x.Z)({},C())),S?(0,Z.jsx)(w.Typography,{variant:"h6",children:"Drop the BCF here ..."}):(0,Z.jsx)(w.Typography,{variant:"h6",children:"Drag 'n' drop a BCF here, or click to select"})]})),c&&(0,Z.jsx)(w.Grid,{container:!0,spacing:2,children:g.map((function(e,t){return(0,Z.jsx)(w.Grid,{item:!0,children:(0,Z.jsx)(ae,{topic:e,onOpenViewpoint:b})},t)}))})]}),(0,Z.jsx)(w.DialogActions,{children:(0,Z.jsx)(te.Z,{onClick:n,children:"Close"})})]})}function ae(e){var t=e.topic,n=e.onOpenViewpoint,a=ne(),i=(0,r.useState)(null),o=(0,m.Z)(i,2),c=(o[0],o[1],(0,r.useState)("")),s=(0,m.Z)(c,2),l=s[0];s[1];return(0,Z.jsx)(Q.Z,{className:a.root,children:(0,Z.jsxs)(K.Z,{onClick:function(){t.viewpoints.length>0&&n(t.viewpoints[0])},children:[(0,Z.jsx)(ee.Z,{className:a.media,image:l,title:t.markup.topic.title}),(0,Z.jsxs)($.Z,{children:[(0,Z.jsx)(w.Typography,{gutterBottom:!0,variant:"h5",component:"h2",children:t.markup.topic.title}),(0,Z.jsx)(w.Typography,{variant:"body2",color:"textSecondary",component:"p",children:t.markup.topic.description})]})]})})}var ie=n(5381),oe=n(7729),ce=n(37397),se=n(71535),le=n(17123),de=n(29156),ue=n(78774),pe=(0,w.makeStyles)((function(e){return{root:{flexGrow:1,"& .MuiTextField-root":{margin:e.spacing(1),backgroundColor:"white"}},button:{backgroundColor:"#E6464D",color:"white","&:hover":{backgroundColor:"#E6464D",color:"white"},"&:disabled":{opacity:.8,color:"white"}},datBimTitle:{textAlign:"center",textTransform:"none"}}})),he=function(e){var t,n,a=e.handleSubmit,i=pe(),o=localStorage.getItem("email"),c=(0,r.useState)(o),s=(0,m.Z)(c,2),l=s[0],d=s[1];return t="https://alliance-batiment.mydatbim.com/template/espace-client",n="https://alliance-batiment.mydatbim.com/inscription/oublie-mdp",(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("h2",{className:i.datBimTitle,children:"Open dthX API Connexion"}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)("form",{className:i.root,noValidate:!0,autoComplete:"off",onSubmit:a,children:(0,Z.jsxs)(w.FormControl,{fullWidth:!0,className:i.margin,children:[(0,Z.jsx)(w.TextField,{id:"filled-basic",label:"Email",name:"email",variant:"filled",value:l,onChange:function(e){d(e.target.value)}}),(0,Z.jsx)(w.TextField,{type:"password",id:"outlined-basic",label:"Mot de passe",name:"password",variant:"filled"}),(0,Z.jsx)(w.Button,{type:"submit",className:i.button,children:"Connexion"}),(0,Z.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:"Cr\xe9er un compte"}),(0,Z.jsx)("a",{href:n,target:"_blank",rel:"noreferrer",children:"Mot de passe oubli\xe9?"})]})})})]})},fe=n(96992),me=n.n(fe),xe=(0,w.makeStyles)((function(e){return{root:{flexGrow:1,"& .MuiTextField-root":{margin:e.spacing(1),backgroundColor:"white"}},datBimCard:{backgroundColor:"#E6464D",color:"white",margin:e.spacing(1),cursor:"pointer",height:"8em"},datBimCardTitle:{margin:0,color:"white"},loader:{color:"inherit",marginTop:"80px"}}})),ge=function(e){var t=e.openObjects,n=e.setBreadcrumbMap,a=e.handleNext,i=e.setActiveStep,o=xe(),c=(0,r.useState)([]),s=(0,m.Z)(c,2),l=s[0],d=s[1],u=(0,r.useState)(!1),p=(0,m.Z)(u,2),h=p[0],f=p[1];return(0,r.useEffect)((function(){var e=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var t;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,f(!0),e.next=4,me().get("".concat("https://rest-api-rw.datbim.com/v3","/portals"),{headers:{"X-Auth-Token":sessionStorage.getItem("token")}});case 4:t=e.sent,d(t.data.data),f(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),i(0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsxs)(w.Grid,{container:!0,spacing:1,children:[(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(w.Typography,{variant:"subtitle1",component:"h3",children:"S\xe9lectionnez un portail:"})}),h?(0,Z.jsx)(w.Grid,{container:!0,justify:"center",children:(0,Z.jsx)(w.CircularProgress,{className:o.loader})}):(0,Z.jsx)(Z.Fragment,{children:null===l||void 0===l?void 0:l.map((function(e){return(0,Z.jsx)(w.Grid,{item:!0,lg:4,children:(0,Z.jsx)(w.Card,{className:"".concat(o.root," ").concat(o.datBimCard),children:(0,Z.jsx)(w.CardContent,{onClick:function(){t(e.portal_id),n([e.portal_name]),a()},children:(0,Z.jsx)(w.Typography,{variant:"h6",component:"h3",className:o.datBimCardTitle,children:"".concat(e.portal_name)})})},e.portal_id)})}))})]})})},ve=n(39153),be=n(11908),Ie=(0,b.Z)((function(e){return{search:{height:"3em",padding:"2px 4px",display:"flex",alignItems:"center",width:"100%","&:disabled":{cursor:"not-allowed"}},input:{marginLeft:e.spacing(1),flex:1},iconButton:{border:"none",color:"black"}}})),we=function(e){e.keyword;var t=e.onChange,n=e.placeholder,r=(e.className,e.onClickOne),a=e.onClickTwo,i=e.disabled,o=e.input,c=Ie();return(0,Z.jsxs)(w.Paper,{component:"form",className:c.search,children:[(0,Z.jsx)(w.InputBase,{disabled:i,value:o,className:c.input,placeholder:n,inputProps:{"aria-label":"search google maps"},onChange:function(e){return t(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&(0===e.target.value.length?e.preventDefault():(e.preventDefault(),r()))}}),(0,Z.jsxs)(w.ButtonGroup,{"aria-label":"search button group",children:[(0,Z.jsx)(w.Button,{className:c.iconButton,disabled:i,onClick:function(){o.length>0&&r()},children:(0,Z.jsx)(ve.Z,{})}),(0,Z.jsx)(w.Button,{className:c.iconButton,disabled:i,onClick:a,children:(0,Z.jsx)(be.Z,{})})]})]})},je=n(29378),ye=n(57043),Ce=n(4314),Ze=n(6486),Se=function(e){var t=e.selectedPortal,n=e.getobjectsSetsBySelectedClass,a=(0,r.useState)({}),i=(0,m.Z)(a,2),o=i[0],c=i[1],s=(0,r.useState)(!1),l=(0,m.Z)(s,2),d=l[0],u=l[1];(0,r.useEffect)((function(){p()}),[]);var p=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var n;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u(!0),e.next=4,me().get("".concat("https://rest-api-rw.datbim.com/v3","/portals/").concat(t,"/tree-class"),{headers:{"X-Auth-Token":sessionStorage.getItem("token")}});case 4:n=e.sent,c({id:"ClassList",name:"Liste des classes",children:n.data}),u(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return(0,Z.jsx)(Z.Fragment,{children:d?(0,Z.jsx)(w.Grid,{container:!0,justify:"center",children:(0,Z.jsx)(w.CircularProgress,{color:"inherit"})}):(0,Z.jsx)(Z.Fragment,{children:o&&(0,Z.jsxs)(ye.Z,{"aria-label":"rich object",defaultCollapseIcon:(0,Z.jsx)(Ze.Z,{}),defaultExpandIcon:(0,Z.jsx)(y.Z,{}),defaultExpanded:["ClassList"],sx:{height:110,flexGrow:1,maxWidth:400,overflowY:"auto"},children:[console.log("classListing",o),function e(t){return(0,Z.jsx)(Ce.Z,{nodeId:t.id,label:t.name,onClick:function(){0===t.children.length&&(console.log("nodes.id",t.id),n(t.id))},children:Array.isArray(t.children)&&t.children.map((function(t){return(0,Z.jsx)("div",{children:e(t)})}))},t.id)}(o)]})})})},ke=n(42629),Ee=(0,w.makeStyles)((function(e){return{root:{flexGrow:1,"& .MuiTextField-root":{margin:e.spacing(1),backgroundColor:"white"}},datBimCard:{backgroundColor:"#E6464D",color:"white",margin:e.spacing(1),cursor:"pointer",height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},datBimCardActionArea:{width:"100%",height:"100%"},datBimCardContent:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",padding:0},datBimCardTitle:{fontSize:12,margin:0,color:"white",fontWeight:"bold",padding:"1.5em 0 0 1.5em"},datBimCardDesc:{fontSize:8,margin:0},datBimCardImg:{width:"100%",height:"100%",marginBottom:"1em",maxHeight:"250px",objectFit:"contain"},button:{backgroundColor:"#E6464D",color:"white","&:hover":{backgroundColor:"#E6464D",color:"white"},"&:disabled":{opacity:.8,color:"white"}},link:{color:"inherit","&:hover":{color:"textPrimary",cursor:"pointer",textDecoration:"underline"}},noObjectSetsMessage:{textAlign:"center"}}})),De=function(e){var t=e.viewer,n=e.selectedPortal,a=e.setSelectedObjectSet,i=e.setSelectedObjectSetName,o=e.eids,c=e.breadcrumbMap,s=e.setBreadcrumbMap,l=e.handleNext,d=e.setActiveStep,u=Ee(),p=(0,r.useState)([]),h=(0,m.Z)(p,2),f=h[0],x=h[1],g=(0,r.useState)([]),v=(0,m.Z)(g,2),b=v[0],I=v[1],j=(0,r.useState)([]),y=(0,m.Z)(j,2),C=y[0],S=y[1],k=(0,r.useState)(""),E=(0,m.Z)(k,2),D=E[0],B=E[1],A=(0,r.useState)(!1),L=(0,m.Z)(A,2),N=L[0],M=L[1];(0,r.useEffect)((function(){R()}),[o]);var R=function(){B(""),o.length>0?G():(x(b),_())},_=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var t,r;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,M(!0),!(b&&b.length>0)){e.next=6;break}M(!1),e.next=16;break;case 6:return e.next=8,me().get("".concat("https://rest-api-rw.datbim.com/v3","/portals/").concat(n,"/object-sets"),{headers:{"X-Auth-Token":sessionStorage.getItem("token")}});case 8:t=e.sent,console.log("objectsSetsList",f),r=t.data.data,console.log("objectsSetsList",r),I(r),x(r),console.log("objectsSetsListDefault",r),M(!1);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var r;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,M(!0),e.next=4,me().get("".concat("https://rest-api-rw.datbim.com/v3","/portals/").concat(n,"/object-sets/classes/").concat(t),{headers:{"X-Auth-Token":sessionStorage.getItem("token")}});case 4:r=e.sent,x(r.data.data),S(r.data.data),M(!1),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var r,a;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,M(!0),e.next=4,t.IFC.loader.ifcManager.getIfcType(0,o[0]);case 4:return r=e.sent,console.log("ifcClass",r),e.next=8,me().get("".concat("https://rest-api-rw.datbim.com/v3","/classes/mapping/").concat(r),{headers:{"X-Auth-Token":sessionStorage.getItem("token")}});case 8:a=e.sent,Promise.allSettled(a.data.data.map(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me().get("".concat("https://rest-api-rw.datbim.com/v3","/portals/").concat(n,"/object-sets/classes/").concat(t.class_reference_id),{headers:{"X-Auth-Token":sessionStorage.getItem("token")}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(e){var t=e.reduce((function(e,t){return"fulfilled"===t.status&&t.value.data.data.map((function(t){return e.push(t)})),e}),[]);S(t),x(t),M(!1)})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var t;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,M(!0),e.next=4,me().get("".concat("https://rest-api-rw.datbim.com/v3","/portals/").concat(n,"/organizations"),{headers:{"X-Auth-Token":sessionStorage.getItem("token")}});case 4:t=e.sent,Promise.allSettled(t.data.data.map(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me()({method:"get",url:"".concat("https://rest-api-rw.datbim.com/v3","/organizations/").concat(t.organization_id,"/object-sets"),params:{search:"".concat(D)},headers:{"X-Auth-Token":sessionStorage.getItem("token")}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(e){var t=e.reduce((function(e,t){return"fulfilled"===t.status&&t.value.data.data.map((function(t){return e.push(t)})),e}),[]);x(t),M(!1)})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),z=o.length>0&0===D.length?C:f;return(0,Z.jsxs)(w.Grid,{container:!0,spacing:3,children:[(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsxs)(w.Breadcrumbs,{separator:(0,Z.jsx)(ke.Z,{fontSize:"small"}),"aria-label":"breadcrumb",children:[(0,Z.jsx)(w.Typography,{className:u.link,onClick:function(e){return d(1)},children:"Portails"}),(0,Z.jsx)(w.Typography,{color:"textPrimary",children:c[0].length>15?c[0].slice(0,15)+"...":c[0]})]})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(w.Typography,{variant:"subtitle1",component:"h3",children:"S\xe9lectionnez une collection d'objets:"})}),(0,Z.jsx)(w.Divider,{}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(we,{disabled:!0===N,input:D,onChange:function(e){if(o.length>0)if(C&&C.length>0){var t=C.filter((function(t){var n=t.object_name.toLowerCase().includes(e.toLowerCase()),r=t.organization_name.toLowerCase().includes(e.toLowerCase());return n||(r||void 0)}));B(e),x(t)}else B(e);else if(b&&b.length>0){var n=b.filter((function(t){var n=t.object_name.toLowerCase().includes(e.toLowerCase()),r=t.organization_name.toLowerCase().includes(e.toLowerCase());return n||(r||void 0)}));B(e),x(n)}},className:u.searchBar,placeholder:"Mot cl\xe9",onClickOne:W,onClickTwo:function(){B(""),x(b),o.length>0&&G()}})}),N?(0,Z.jsx)(w.Grid,{container:!0,justify:"center",children:(0,Z.jsx)(w.CircularProgress,{color:"inherit"})}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(w.Grid,{item:!0,xs:4,children:(0,Z.jsx)(Se,{selectedPortal:n,getobjectsSetsBySelectedClass:O})}),(0,Z.jsx)(w.Grid,{item:!0,xs:8,children:N?(0,Z.jsx)(w.Grid,{container:!0,justify:"center",children:(0,Z.jsx)(w.CircularProgress,{color:"inherit"})}):(0,Z.jsxs)(w.Grid,{container:!0,spacing:1,children:[0===z.length?(0,Z.jsx)(w.Grid,{item:!0,sm:12,className:u.noObjectSetsMessage,children:"Aucune collection trouv\xe9e. Veuillez faire une recherche par mot cl\xe9."}):z.map((function(e,t){return(0,Z.jsx)(w.Grid,{item:!0,sm:4,children:(0,Z.jsxs)(w.Card,{className:"".concat(u.root," ").concat(u.datBimCard),children:[(0,Z.jsx)(w.CardActionArea,{className:"".concat(u.datBimCardActionArea),children:(0,Z.jsxs)(w.CardContent,{className:"".concat(u.datBimCardContent),onClick:function(){a(e.object_id),i(e.object_name),s([].concat((0,T.Z)(c),[e.object_name])),l()},children:[(0,Z.jsxs)(w.Typography,{className:u.datBimCardTitle,children:[e.object_name,(0,Z.jsx)("br",{})]}),(0,Z.jsx)("img",{className:u.datBimCardImg,src:e.img_ref,alt:e.object_name})]})}),(0,Z.jsx)(w.CardActions,{children:(0,Z.jsx)(w.Chip,{className:u.datBimCardDesc,label:"".concat(e.organization_name)})})]},t)})})),(null===f||void 0===f?void 0:f.meta)&&(0,Z.jsx)(je.Z,{count:f.meta.current_items,onChange:function(e,t){return R()},variant:"outlined"})]})})]})]})},Te=n(30070);n(80681);function Fe(e){return"".concat(e)}function Pe(e){return"S"===e}var Be=function(e,t,n,r){var a=null;switch(e){case"R\xe9el":case"Entier":a=(0,Z.jsx)(w.Input,{type:"number",name:"text_value",fullWidth:!0,value:t.text_value,disabled:Pe(t.property_type),onChange:r(n)});break;case"Date":a=(0,Z.jsx)(w.Input,{type:"date",name:"text_value",format:"DD/MM/YYYY",fullWidth:!0,value:t.text_value,disabled:Pe(t.property_type),onChange:r(n)});break;case"Lien":case"Texte":case"Texte param\xe9trique":a=(0,Z.jsx)(w.Input,{type:"text",name:"text_value",fullWidth:!0,value:t.text_value,disabled:Pe(t.property_type),onChange:r(n)});break;case"Liste":a=(0,Z.jsx)(w.Select,{name:"text_value",fullWidth:!0,value:t.text_value,disabled:Pe(t.property_type),onChange:r(n),children:t.list_value.map((function(e,t){return(0,Z.jsx)(w.MenuItem,{value:e,children:e},t)}))});break;case"Grid/Tableau":var i=JSON.parse(t.text_value).values;a=(0,Z.jsx)(w.TableContainer,{children:(0,Z.jsx)(w.Table,{style:{minWidth:650},"aria-label":"simple table",children:(0,Z.jsx)(w.TableBody,{children:i.map((function(e,t){return(0,Z.jsx)(w.TableRow,{style:{"&:last-child td, &:last-child th":{border:0}},children:e.map((function(e,n){return(0,Z.jsx)(w.TableCell,{component:"th",scope:"row",children:e.data},"cell ".concat(t," ").concat(n))}))},"row ".concat(t))}))})})});break;case"Bool\xe9en":a=(0,Z.jsxs)(w.RadioGroup,{name:"text_value",value:"".concat(t.text_value),onChange:r(n),row:!0,children:[(0,Z.jsx)(w.FormControlLabel,{value:"true",control:(0,Z.jsx)(w.Radio,{}),label:"OUI",disabled:Pe(t.property_type)}),(0,Z.jsx)(w.FormControlLabel,{value:"false",control:(0,Z.jsx)(w.Radio,{}),label:"NON",disabled:Pe(t.property_type)})]});break;case"Intervalle":var o=[{label:"".concat(t.min_interval),value:t.min_interval},{label:"".concat(t.max_interval),value:t.max_interval}];a=(0,Z.jsx)(w.Slider,{disabled:Pe(t.property_type),name:"num_value",onChange:r(n,"num_value"),defaultValue:parseFloat(t.num_value),getAriaValueText:Fe,"aria-labelledby":"discrete-slider-custom",min:parseFloat(t.min_interval),step:.1*Math.pow(10,Math.floor(Math.log10(t.max_interval-t.min_interval))),value:t.num_value,max:parseFloat(t.max_interval),marks:o,valueLabelDisplay:"auto"});break;default:console.log("Sorry, we are out of ".concat(e,"."))}return a},Ae=n(21811),Le=(0,w.makeStyles)((function(e){return{searchBar:{width:"100%",underline:"black",margin:"20px 0px","&:before":{borderBottom:"1px solid #E6464D"},"&:after":{borderBottom:"2px solid #E6464D"}},datBimList:{color:"white","&:nth-child(odd)":{backgroundColor:"#DCDCDC",opacity:.8}},datBimCardTitle:{margin:0,color:"white"},table:{minWidth:"100%"},button:{marginTop:"10px",backgroundColor:"#E6464D",color:"white","&:hover":{backgroundColor:"#E6464D",color:"white"},"&:disabled":{opacity:.8,color:"white"}}}})),Ne=function(e){e.projectId,e.setLoader,e.objSelected;var t=e.selectedObject,n=e.bimData,a=e.setBimData,i=e.viewer,o=e.modelID,c=e.eids,s=(e.setEids,e.addElementsNewProperties),d=e.handleShowMarketplace,u=(0,r.useState)(""),p=(0,m.Z)(u,2),h=(p[0],p[1],(0,r.useState)([])),f=(0,m.Z)(h,2),g=(f[0],f[1]),v=(0,r.useState)([]),b=(0,m.Z)(v,2),I=b[0],j=b[1],y=(0,r.useState)(!0),C=(0,m.Z)(y,2),S=C[0],k=C[1],E=((0,l.useHistory)(),Le());(0,r.useEffect)((function(){var e=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var n,r,a,i,o;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,me().get("".concat("https://rest-api-rw.datbim.com/v3","/objects/").concat(t,"/properties-values"),{headers:{"X-Auth-Token":sessionStorage.getItem("token")}});case 3:n=e.sent,r=n.data,a=r.data.filter((function(e){return e.property_visibility})),i=a.map((function(e){return(0,x.Z)((0,x.Z)({},e),{},{checked:!0})})),o=i.map((function(e){if("Entier"===e.data_type_name&&"A saisir"===e.text_value)return(0,x.Z)((0,x.Z)({},e),{},{text_value:0});if("Lien"===e.data_type_name){var t=e.text_value.replace("Https","https");return(0,x.Z)((0,x.Z)({},e),{},{text_value:t})}return e})),g(o),j(o),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("error",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();e()}),[t]);var D=function(e){console.log("properties",I);var t=e.target.id,n=e.target.checked,r=(0,T.Z)(I);if(r[t].checked=n,n)for(var a=0;a<I.length;a++){if(!0!==I[a].checked){k(!1);break}k(!0)}else k(!1);j(r)},B=function(e,t){return function(t,n){var r=t.target.value,a=I[e],i=(0,T.Z)(I);if("Intervalle"===a.data_type_name)i[e].num_value=r||n,i[e].text_value=r||n;else i[e].text_value=r||n;j(i)}},A=function(e){switch(e.data_type_name){case"Intervalle":return(0,x.Z)((0,x.Z)({},e),{},{text_value:e.num_value,value:e.num_value});case"Grid/Tableau":var t,n=JSON.parse(e.text_value).values,r=[],a=(0,Te.Z)(n);try{for(a.s();!(t=a.n()).done;){var i=t.value;r.push("".concat(i[0].data,": ").concat(i[1].data))}}catch(o){a.e(o)}finally{a.f()}return(0,x.Z)((0,x.Z)({},e),{},{text_value:r.toString(),value:r.toString()});default:return(0,x.Z)((0,x.Z)({},e),{},{value:e.text_value})}},L=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t,r){var l,u,p,h,f,m;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=t.filter((function(e){return e.checked})),u=[],p=(0,Te.Z)(l);try{for(p.s();!(h=p.n()).done;)f=h.value,u.push(A(f))}catch(x){p.e(x)}finally{p.f()}return console.log("updateProperties",u),console.log("objSelected",r),e.next=8,me()({method:"post",url:"".concat("https://rest-api-rw.datbim.com/v3","/objects/").concat(r,"/signing"),headers:{"content-type":"application/json","X-Auth-Token":sessionStorage.getItem("token")},data:u});case 8:return m=e.sent,console.log("data",m.data),e.next=12,s({bimData:n,setBimData:a,viewer:i,modelID:o,expressIDs:c,properties:m.data.property?m.data.property:u});case 12:d("home");case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return console.log("properties",I),(0,Z.jsxs)(w.TableContainer,{component:w.Paper,children:[(0,Z.jsxs)(w.Table,{className:E.table,"aria-label":"simple table",children:[(0,Z.jsx)(w.TableHead,{children:(0,Z.jsxs)(w.TableRow,{className:"".concat(E.root," ").concat(E.datBimCardTitle),children:[(0,Z.jsx)(w.TableCell,{children:"Propri\xe9t\xe9"}),(0,Z.jsx)(w.TableCell,{align:"center",children:"Info"}),(0,Z.jsx)(w.TableCell,{align:"center",children:"Valeur"}),(0,Z.jsx)(w.TableCell,{align:"center",children:"Unit\xe9"}),t?(0,Z.jsxs)(w.TableCell,{align:"center",children:["Ajouter",(0,Z.jsx)(w.Checkbox,{defaultChecked:!0,checked:S,onChange:function(e){e.target.checked?(I.map((function(e){e.checked=!0})),k(!0)):(I.map((function(e){e.checked=!1})),k(!1))}})]}):""]})}),(0,Z.jsx)(w.TableBody,{children:null===I||void 0===I?void 0:I.map((function(e,t){return(0,Z.jsxs)(w.TableRow,{className:"".concat(E.root," ").concat(E.datBimList),children:[(0,Z.jsx)(w.TableCell,{width:"35%",component:"th",scope:"row",children:e.property_name}),(0,Z.jsx)(w.TableCell,{width:"10%",component:"th",scope:"row",children:e.property_definition&&(0,Z.jsx)(w.Tooltip,{title:"".concat(e.property_definition),placement:"top-start",children:(0,Z.jsx)(w.IconButton,{children:(0,Z.jsx)(Ae.Z,{})})})}),(0,Z.jsx)(w.TableCell,{width:"35%",align:"right",children:Be(e.data_type_name,e,t,B)}),(0,Z.jsx)(w.TableCell,{width:"10%",align:"center",children:e.unit}),(0,Z.jsx)(w.TableCell,{width:"10%",align:"center",children:(0,Z.jsx)(w.Checkbox,{defaultChecked:!0,checked:I[t].checked,onChange:D,id:t})})]},t)}))})]}),(0,Z.jsx)(w.Grid,{row:!0,align:"right",children:(0,Z.jsx)(w.Button,{variant:"contained",onClick:function(){L(I,t)},color:"primary",className:E.button,children:"Ajouter"})})]})},Me=(0,w.makeStyles)((function(e){return{datBIMColor:{color:"#E6464D"},slider:{marginTop:"25px"}}})),Re=function(e){return"".concat(e)},_e=function(e){return"S"===e},Oe=function(e){var t=e.type,n=e.selector,a=e.selectorsRequest,i=e.setSelectorsRequest,o=e.getObjectsOfAdvancedSearch,c=Me(),s=(0,r.useState)([n.value_min,n.value_max]),l=(0,m.Z)(s,2),d=l[0],u=l[1],p=(0,r.useState)(""),h=(0,m.Z)(p,2),f=h[0],x=h[1],g=[{label:"".concat(n.value_min),value:n.value_min},{label:"".concat(n.value_max),value:n.value_max}],v=null;switch(t){case"text":v=(0,Z.jsx)(w.Input,{type:"text",name:"text_value",fullWidth:!0,value:n.text_value,disabled:_e(n.selector_type),onChange:x});break;case"list":v=(0,Z.jsx)(w.Select,{name:"text_value",fullWidth:!0,value:n.text_value,disabled:_e(n.selector_type),onChange:function(e,t){var r=(0,T.Z)(a),o=!1;a.forEach((function(e,a){e.id===n.id&&(o=!0,r.splice(a,1,{id:e.id,type:e.type,value:f&&f.length>0?f:t.props.value}))})),o||r.push({id:n.id,type:n.type,value:f&&f.length>0?f:t.props.value}),i(r)},children:n.list_value.map((function(e,t){return(0,Z.jsx)(w.MenuItem,{value:e,children:e},t)}))});break;case"interval":v=(0,Z.jsx)(w.Slider,{className:"".concat(c.slider," ").concat(c.datBIMColor),defaultValue:n.value_min,getAriaValueText:Re,"aria-labelledby":"discrete-slider",valueLabelDisplay:"auto",step:(n.value_max-n.value_min)/100,marks:g,min:n.value_min,max:n.value_max,onChangeCommitted:function(e,t){var r=(0,T.Z)(a),c=!1;a.forEach((function(e,a){e.id===n.id&&(c=!0,r.splice(a,1,{id:e.id,type:e.type,value:t}))})),c||r.push({id:n.id,type:n.type,value:t}),i(r),o(r)}});break;case"definition":console.log("definition",n),console.log("selector.value_min",parseInt(n.value_min)),v=(0,Z.jsx)(w.Slider,{className:"".concat(c.slider," ").concat(c.datBIMColor),name:"text_value",getAriaValueText:Re,"aria-labelledby":"range-slider",valueLabelDisplay:"auto",defaultValue:d,step:(n.value_max-n.value_min)/100,marks:g,value:d,min:n.value_min,max:n.value_max,onChange:function(e,t){u(t)},onChangeCommitted:function(e){var t=(0,T.Z)(a),r=!1;a.forEach((function(e,a){e.id===n.id&&(r=!0,t.splice(a,1,{id:e.id,type:e.type,value_min:d[0],value_max:d[1]}))})),r||t.push({id:n.id,type:n.type,value_min:d[0],value_max:d[1]}),i(t),o(t)}});break;default:console.log("Sorry, we are out of ".concat(t,"."))}return v},Ge=function(e){var t=e.selectors,n=e.selectorsLoader,r=e.getObjectsOfAdvancedSearch,a=e.selectorsRequest,i=e.setSelectorsRequest,o=e.resetSelectors;return(0,Z.jsxs)(w.Accordion,{children:[(0,Z.jsx)(w.AccordionSummary,{expandIcon:(0,Z.jsx)(Ze.Z,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:(0,Z.jsx)(w.Typography,{children:"S\xe9lection"})}),(0,Z.jsx)(w.AccordionDetails,{children:n?(0,Z.jsx)(w.Grid,{container:!0,justify:"center",children:(0,Z.jsx)(w.CircularProgress,{color:"inherit"})}):(0,Z.jsxs)(w.Grid,{container:!0,spacing:2,children:[(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:t&&t.length>0?(0,Z.jsx)(w.TableContainer,{component:w.Paper,children:(0,Z.jsx)(w.Table,{"aria-label":"simple table",children:(0,Z.jsx)(w.TableBody,{children:null===t||void 0===t?void 0:t.map((function(e,t){return(0,Z.jsxs)(w.TableRow,{children:[(0,Z.jsx)(w.TableCell,{width:"40%",component:"th",scope:"row",children:e.name}),(0,Z.jsx)(w.TableCell,{width:"40%",align:"right",children:Oe({type:e.type,selector:e,selectorsRequest:a,setSelectorsRequest:i,getObjectsOfAdvancedSearch:r})}),(0,Z.jsx)(w.TableCell,{width:"10%",align:"center",children:e.unit})]},e.id)}))})})}):(0,Z.jsx)(w.Typography,{children:"Aucun s\xe9lecteur disponible"})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,style:{textAlign:"right"},children:(0,Z.jsx)(w.Button,{variant:"contained",onClick:o,color:"primary",style:{backgroundColor:"#E6464D",color:"white"},children:"R\xe9initialiser"})})]})})]})},We=(0,w.makeStyles)((function(e){return{link:{color:"inherit","&:hover":{color:"textPrimary",cursor:"pointer",textDecoration:"underline"}},button:{backgroundColor:"#E6464D",color:"white","&:hover":{backgroundColor:"#E6464D",color:"white"},"&:disabled":{opacity:.8,color:"white"}}}})),ze=function(e){var t=e.bimData,n=e.setBimData,a=e.projectId,i=e.objSelected,o=e.addElementsNewProperties,c=e.selectedObject,s=e.selectedObjectSet,l=e.setSelectedObject,d=e.viewer,u=e.modelID,p=e.eids,h=e.setEids,f=e.breadcrumbMap,x=e.handleShowMarketplace,g=e.setActiveStep,v=We(),b=(0,r.useState)(""),I=(0,m.Z)(b,2),j=I[0],C=I[1],S=(0,r.useState)([]),k=(0,m.Z)(S,2),E=k[0],D=k[1],T=(0,r.useState)([]),B=(0,m.Z)(T,2),A=B[0],L=B[1],N=(0,r.useState)(!1),M=(0,m.Z)(N,2),R=M[0],_=M[1],O=(0,r.useState)(!1),G=(0,m.Z)(O,2),W=G[0],z=G[1],H=(0,r.useState)({}),V=(0,m.Z)(H,2),U=V[0],Y=V[1],X=(0,r.useState)(""),q=(0,m.Z)(X,2),J=q[0],Q=q[1];(0,r.useEffect)((function(){K(),ee()}),[]);var K=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var t;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,_(!0),e.next=4,me().get("".concat("https://rest-api-rw.datbim.com/v3","/objects/").concat(s,"/get-selector"),{headers:{"content-type":"application/json","X-Auth-Token":sessionStorage.getItem("token")}});case 4:t=e.sent,D(t.data),_(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,_(!0),z(!0),e.next=5,me()({method:"post",url:"".concat("https://rest-api-rw.datbim.com/v3","/objects/").concat(s,"/search-on-selector?tree=1"),headers:{"content-type":"application/json","X-Auth-Token":sessionStorage.getItem("token")},data:{keyword:j,property:t}});case 5:n=e.sent,D(n.data.search),Y({id:"FiltredObjects",name:"Liste des objets filtr\xe9s",children:n.data.result}),_(!1),z(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var t;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,z(!0),e.next=4,me().get("".concat("https://rest-api-rw.datbim.com/v3","/objects/").concat(s,"/tree-structure"),{headers:{"content-type":"application/json","X-Auth-Token":sessionStorage.getItem("token")}});case 4:t=e.sent,Y(t.data),z(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),te=function(){C(""),L([]),K(),ee(),l(null)},ne=function(e,t){var n=(0,m.Z)(e,2),r=n[0],a=n[1],i=re(t,a),o=(0,m.Z)(i,2),c=o[0],s=o[1];return[r.concat((0,Z.jsx)("div",{children:c})),s]},re=function(e,t){var n=Array.isArray(e.children)&&e.children.length>0?e.children.reduce(ne,[[],t]):[null,t+1],r=(0,m.Z)(n,2),a=r[0],i=r[1];return[(0,Z.jsx)(Ce.Z,{nodeId:e.id,label:e.name,onClick:function(){l(e.id),Q(e.name)},children:a},e.id),i]},ae=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t,n){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.push("".concat(n.id)),n.children&&n.children.length>0&&n.children.forEach((function(e){ae(t,e)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ie=null;if(U){var oe=re(U,0),ce=(0,m.Z)(oe,2),se=ce[0],le=ce[1],de=[];"FiltredObjects"===U.id&&(ae(de,U),console.log("selectedObjectListing",de)),console.log("objectListing",U),console.log("selectedObjectListing",de),ie=(0,Z.jsxs)(w.Grid,{item:!0,xs:12,children:[(0,Z.jsxs)(w.Typography,{children:["Objets trouv\xe9s: ",le]}),(0,Z.jsx)(ye.Z,{"aria-label":"rich object",defaultCollapseIcon:(0,Z.jsx)(Ze.Z,{}),defaultExpanded:"FiltredObjects"===U.id?de:["".concat(U.id)],defaultExpandIcon:(0,Z.jsx)(y.Z,{}),sx:{height:1100,flexGrow:1,maxWidth:400,overflowY:"auto"},children:se})]})}return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsxs)(w.Grid,{container:!0,spacing:3,children:[(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsxs)(w.Breadcrumbs,{separator:(0,Z.jsx)(ke.Z,{fontSize:"small"}),"aria-label":"breadcrumb",children:[(0,Z.jsx)(w.Typography,{href:"/",className:v.link,onClick:function(e){return g(1)},children:"Portails"}),(0,Z.jsx)(w.Typography,{href:"/",className:v.link,onClick:function(e){return g(2)},children:f[0].length>15?f[0].slice(0,15)+"...":f[0]}),(0,Z.jsx)(w.Typography,{color:J?"inherit":"textPrimary",children:f[1]})]})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(w.Typography,{variant:"subtitle1",component:"h3",children:"S\xe9lectionnez un objet: ".concat(J)})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(we,{disabled:!0===W,input:j,onChange:function(e){console.log(e),C(e)},className:v.searchBar,placeholder:"Mot cl\xe9",onClickOne:function(){return $(A)},onClickTwo:te})}),(0,Z.jsx)(w.Divider,{}),(0,Z.jsx)(w.Grid,{item:!0,sm:5,children:W?(0,Z.jsx)(w.Grid,{container:!0,justify:"center",children:(0,Z.jsx)(w.CircularProgress,{color:"inherit"})}):(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsxs)(w.Grid,{container:!0,spacing:2,children:[(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(Ge,{zIndex:"2",selectors:E,selectorsLoader:R,getObjectsOfAdvancedSearch:$,selectorsRequest:A,setSelectorsRequest:L,resetSelectors:te})}),ie]})})}),(0,Z.jsx)(w.Grid,{item:!0,sm:7,children:(0,Z.jsx)(Ne,{classes:v,projectId:a,objSelected:i,selectedObject:c,bimData:t,setBimData:n,viewer:d,modelID:u,eids:p,setEids:h,addElementsNewProperties:o,handleShowMarketplace:x})})]})})},He=n(321),Ve=n(6359),Ue=(0,w.makeStyles)((function(e){return{root:{flexGrow:1,"& .MuiTextField-root":{margin:e.spacing(1),backgroundColor:"white"}},button:{fontSize:40,borderRadius:"10%",backgroundColor:"#E6464D",color:"white","&:hover":{backgroundColor:"#E6464D",color:"white",cursor:"pointer"},"&:disabled":{opacity:.8,color:"white"}},headerButton:{borderRadius:"50%",color:"#E6464D","&:hover":{color:"white",backgroundColor:"#E6464D",cursor:"pointer"}},navigationBar:{margin:0,bottom:0,width:"100%",backgroundColor:"white",padding:"10px"},modal:{display:"flex",padding:e.spacing(1),alignItems:"center",justifyContent:"center"},modalDatBim:{width:"50%",height:"70%",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),overflow:"hidden scroll",position:"relative"},datBimCard:{backgroundColor:"#E6464D",color:"white",margin:e.spacing(1),cursor:"pointer",height:"8em"},datBimTitle:{textAlign:"center",textTransform:"none"},datBimCardTitle:{margin:0,color:"white"},datBimFooterCard:{display:"block",textAlign:"right"},datBimCardButton:{textAlign:"right",color:"white"},accordionDetails:{display:"block"},datBimIcon:{width:"3em"}}})),Ye=(0,w.makeStyles)({root:{color:"#E6464D",display:"flex",height:22,alignItems:"right"},active:{color:"#E6464D"},circle:{width:8,height:8,borderRadius:"50%",backgroundColor:"currentColor"},completed:{color:"#E6464D",zIndex:1,fontSize:18}}),Xe=(0,w.withStyles)({alternativeLabel:{top:10,left:"calc(-50% + 16px)",right:"calc(50% + 16px)"},active:{"& $line":{borderColor:"#E6464D"}},completed:{"& $line":{borderColor:"#E6464D"}},line:{borderColor:"#eaeaf0",borderTopWidth:3,borderRadius:1}})(de.Z),qe=function(e){var t=e.bimData,n=e.setBimData,a=e.viewer,i=e.modelID,o=e.eids,c=e.setEids,s=e.addElementsNewProperties,l=e.handleShowMarketplace,d=(e.s,(0,r.useState)(0)),u=(0,m.Z)(d,2),p=u[0],h=u[1],x=(0,r.useState)([]),g=(0,m.Z)(x,2),b=g[0],I=g[1],j=(0,r.useState)(null),y=(0,m.Z)(j,2),C=y[0],S=y[1],k=(0,r.useState)(null),E=(0,m.Z)(k,2),D=E[0],T=E[1],B=(0,r.useState)(null),A=(0,m.Z)(B,2),L=A[0],N=A[1],M=(0,r.useState)(null),R=(0,m.Z)(M,2),_=R[0],O=R[1],G=(0,r.useState)({status:!0,message:"Connected"}),W=(0,m.Z)(G,2),z=W[0],H=W[1];(0,r.useEffect)((function(){var e=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:sessionStorage.getItem("token")&&J();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var V=["Connexion","Portails","Collections d'objets","Objets"],U=Ue();function Y(e){var t=Ye(),n=e.active,r=e.completed;return(0,Z.jsx)("div",{className:v()(t.root,(0,f.Z)({},t.active,n)),children:r?(0,Z.jsx)(ue.Z,{className:t.completed}):(0,Z.jsx)("div",{className:t.circle})})}var X=function(e){e.preventDefault();var t=new FormData(e.target);localStorage.setItem("email",t.get("email")),me()({method:"post",url:"".concat("https://rest-api-rw.datbim.com/v3","/auth-token"),headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},data:{entry_mode:"string",ip:"string",lang:"fr",local_at:"string",login:"".concat(t.get("email")),password:"".concat(t.get("password")),service:"string"}}).then((function(e){console.log("TOKEN",e.data),sessionStorage.setItem("token",e.data.token),H({status:!0,message:"Connect\xe9"}),J()})).catch((function(e){console.log("error",e),H({status:!1,message:"Erreur de connexion"}),h(0)}))},q=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:sessionStorage.setItem("token",null),h(0);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){h((function(e){return e+1}))};function Q(e){S(e)}return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(w.Grid,{container:!0,children:[(0,Z.jsx)(w.Grid,{item:!0,xs:6,style:{textAlign:"left"},children:p>0&&(0,Z.jsx)(He.Z,{disabled:0===p,onClick:function(){h((function(e){return e-1}))},className:U.headerButton})}),(0,Z.jsx)(w.Grid,{item:!0,xs:6,style:{textAlign:"right"},children:p>0&&(0,Z.jsx)(Ve.Z,{className:U.headerButton,onClick:q})})]}),(0,Z.jsx)(w.Stepper,{alternativeLabel:!0,activeStep:p,connector:(0,Z.jsx)(Xe,{}),children:V.map((function(e){return(0,Z.jsx)(w.Step,{children:(0,Z.jsx)(w.StepLabel,{StepIconComponent:Y,children:e})},e)}))}),(0,Z.jsx)(w.Typography,{className:U.instructions,children:function(e){switch(e){case 0:return(0,Z.jsx)(he,{handleSubmit:X});case 1:return(0,Z.jsx)(ge,{openObjects:Q,setSelectedPortal:S,handleNext:J,breadcrumbMap:b,setBreadcrumbMap:I,setActiveStep:h});case 2:return(0,Z.jsx)(De,{selectedPortal:C,setSelectedObjectSet:T,setSelectedObjectSetName:N,viewer:a,eids:o,breadcrumbMap:b,setBreadcrumbMap:I,handleNext:J,setActiveStep:h});case 3:return(0,Z.jsx)(ze,{selectedObject:_,selectedObjectSet:D,selectedObjectSetName:L,setSelectedObject:O,handleNext:J,selectedPortal:C,typeProperties:"IfcWall",bimData:t,setBimData:n,viewer:a,modelID:i,eids:o,setEids:c,addElementsNewProperties:s,handleShowMarketplace:l,breadcrumbMap:b,setBreadcrumbMap:I,setActiveStep:h});default:return"Unknown step"}}(p)}),!z.status&&0===p&&(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(ie.Alert,{severity:"error",children:"".concat(z.message)})})]})},Je=n.p+"d45a307cf678cd5830eb.jpg",Qe=n(15603),Ke=n.n(Qe),$e=((0,w.makeStyles)((function(e){return{}})),function(e){var t=e.viewer,n=e.onDrop,a=(0,r.useState)({name:"DropBox",img:Je,type:"storage"}),i=(0,m.Z)(a,2),o=i[0];i[1];function c(){return(c=(0,P.Z)((0,F.Z)().mark((function e(r){var a,i,o,c;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(r[0].link,{mode:"no-cors"});case 2:return a=e.sent,e.next=5,a.text();case 5:i=e.sent,o=new Blob([i],{type:"text/plain"}),c=new File([o],"ifcFile"),n({files:[c],viewer:t});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(w.Grid,{container:!0,children:(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(Ke(),{appKey:"qc5xtha8zg1phdb",success:function(e){return c.apply(this,arguments)},cancel:function(){return console.log("closed")},multiselect:!1,extensions:[".ifc"],children:(0,Z.jsx)(w.Card,{children:(0,Z.jsx)(w.CardActionArea,{children:(0,Z.jsx)(w.CardHeader,{avatar:(0,Z.jsx)(w.Avatar,{"aria-label":"recipe",src:o.img,alt:o.name,title:o.name}),title:o.name,subheader:(0,Z.jsx)(w.Badge,{color:"success",pill:!0,children:o.type})})})})})})})})}),et=n.p+"8bde820ab92b00b56f5b.png",tt=function(e){var t=e.title,n=e.placement,r=e.disabled,a=e.className,i=e.onClick,o=e.children;return(0,Z.jsx)(w.Tooltip,{arrow:!0,title:t,placement:n,children:(0,Z.jsx)(w.Fab,{size:"small",className:a,onClick:i,disabled:r,children:o})})},nt=n(70594);n(15462);var rt=n.p+"static/media/TracimLogo.5ddec76c77f0947c2b34359b650a9690.svg",at="http://localhost:5600";var it=(0,w.makeStyles)((function(e){return{root:{flexGrow:1,"& .MuiTextField-root":{margin:e.spacing(1),backgroundColor:"white"}},table:{width:"100%"},iconButton:{backgroundColor:"red"}}})),ot=function(e){e.openProperties,e.projectId,e.objSelected;var t=e.viewer,n=(e.modelID,e.eids,e.setEids,e.addElementsNewProperties,e.handleShowMarketplace,e.setSelectedApp,it()),a=function(e){var t=e.viewer,n=(0,r.useState)(!1),a=(0,m.Z)(n,2),i=(a[0],a[1]),o=(0,r.useState)({lockProject:"",unlockProject:"",updateProject:""}),c=(0,m.Z)(o,2),s=c[0],l=c[1],d=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var n,r,a,i,o,c,d,u,p,h,f;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.IFC.loader.ifcManager.state.api.ExportFileAsIFC(0);case 3:return n=e.sent,console.log("ifcData",n),r=(new TextDecoder).decode(n),console.log("IFC STRING",r),a=r.replace("FILE_NAME('no name', '', (''), (''), 'web-ifc-export');","FILE_NAME('0001','2011-09-07T12:40:02',(''),(''),'Autodesk Revit MEP 2011 - 1.0','20100326_1700 (Solibri IFC Optimizer)','');"),console.log("newIfcDataString",a),i=new Blob([a],{type:"text/plain"}),console.log("ifcBlob",i),o=new File([i],"ifcFile"),console.log("model",o),c=new URLSearchParams(window.location.search),d=c.get("content_id"),u=c.get("space_id"),p=c.get("user_id"),console.log("handleInitTracim Content ID:",d),console.log("handleInitTracim Space ID:",u),console.log("handleInitTracim User ID:",p),(h=new FormData).append("content_id",d),h.append("space_id",u),h.append("user_id",p),h.append("file",o),e.next=27,me().put("".concat(at,"/tracim/updateModel"),h);case 27:f=e.sent,console.log("res",f),l((0,x.Z)((0,x.Z)({},s),{},{updateProject:"Maquette mise \xe0 jour"})),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(0),l((0,x.Z)((0,x.Z)({},s),{},{updateProject:"Non connect\xe9 \xe0 Tracim"}));case 35:case"end":return e.stop()}}),e,null,[[0,32]])})));return function(){return e.apply(this,arguments)}}();return{setLocked:i,setApiInformation:l,handleUpdateProject:d}}({viewer:t}),i=(a.locked,a.setLocked),o=(a.apiInformation,a.setApiInformation,a.handleUpdateProject);return(0,r.useEffect)((function(){function e(){return(e=(0,P.Z)((0,F.Z)().mark((function e(){var t;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=sessionStorage.getItem("axeobim_lock_token"),console.log("lockToekn",t),i(!(!t||""===t));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),(0,Z.jsxs)(ie.Grid,{container:!0,spacing:1,children:[(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:(0,Z.jsx)(ie.Typography,{variant:"subtitle1",component:"h3",children:"Mod\xe8le BIM en cours de traitement:"})}),(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:(0,Z.jsx)(ie.List,{sx:{width:"100%",backgroundColor:"#1890ff",color:"white",borderRadius:"1em"},children:(0,Z.jsx)(ie.ListItem,{secondaryAction:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(ie.Tooltip,{title:(0,Z.jsxs)("p",{children:["Tracim:",(0,Z.jsx)("br",{}),"Mise \xe0 jour de la maquette dans Tracim pour les autres utilisateurs"]}),placement:"top",children:(0,Z.jsx)(ie.IconButton,{edge:"end","aria-label":"comments",onClick:o,className:n.icons,children:(0,Z.jsx)(nt.Z,{sx:{color:"white"}})})})}),disablePadding:!0,children:"Mise \xe0 jour de la maquette dans Tracim"},0)})})]})},ct=(0,w.makeStyles)((function(e){return{heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},table:{width:"100%"},cardExpanded:{position:"absolute",top:"0px",zIndex:1e3,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},card:{position:"absolute",top:"0px",zIndex:100,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},cardContent:{opacity:"0.95",height:"85%",overflowY:"auto",overflowX:"hidden","&::-webkit-scrollbar":{width:"0.4em"},"&::-webkit-scrollbar-track":{"-webkit-box-shadow":"inset 0 0 6px rgba(0,0,0,0.00)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.1)",outline:"0px solid slategrey"}},application:{height:"17em"},avatar:{backgroundColor:"transparent",width:e.spacing(7),height:e.spacing(7),padding:"5px",borderRadius:"0px"},root:{maxWidth:345,margin:"10px",cursor:"pointer"},media:{height:0,paddingTop:"56.25%"},fab:{backgroundColor:"white"},button:{color:"black"}}})),st=[{name:"Open dthX",img:et,type:"data",description:"Base de donn\xe9es permettant l'enrichissement de la maquette"},{name:"Tracim",img:rt,type:"storage",description:"Espace permettant le partage et le stockage de fichier"}],lt=function(e){var t=e.bimData,n=e.setBimData,a=e.viewer,i=e.modelID,o=e.handleShowMarketplace,c=e.eids,s=e.setEids,l=e.onDrop,d=e.addElementsNewProperties,u=e.specificApplication,p=e.apiConnectors,h=(e.setApiConnectors,(0,r.useState)("home")),f=(0,m.Z)(h,2),x=f[0],g=f[1],v=(0,r.useState)(null),b=(0,m.Z)(v,2),I=b[0],j=b[1],y=(0,r.useState)([]),C=(0,m.Z)(y,2),S=C[0],k=C[1],E=(0,r.useState)(""),D=(0,m.Z)(E,2),T=D[0],F=D[1],P=(0,r.useState)(""),B=(0,m.Z)(P,2),A=(B[0],B[1],(0,r.useState)(!1)),L=(0,m.Z)(A,2),N=L[0],M=L[1],R=(0,r.useState)("100%"),_=(0,m.Z)(R,2),O=_[0],G=_[1],W=(0,r.useState)("100%"),z=(0,m.Z)(W,2),V=z[0],U=z[1];(0,r.useEffect)((function(){console.log("apiConnectors",p),k(st),g(u||"home")}),[]);var Y=ct({width:O,height:V});(0,r.useEffect)((function(){var e=function(){N||(G(window.innerWidth-175),U(window.innerHeight-175))};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]);var X=Boolean(I),q=X?"simple-popover":void 0;return(0,Z.jsxs)(w.Card,{className:N?Y.cardExpanded:Y.card,children:[(0,Z.jsx)(w.CardHeader,{avatar:(0,Z.jsx)(w.Avatar,{"aria-label":"recipe",className:Y.avatar,children:(0,Z.jsx)(w.Fab,{size:"small",className:Y.fab,onClick:o,children:(0,Z.jsx)(H.Z,{})})}),action:(0,Z.jsxs)("div",{children:[(0,Z.jsx)(w.IconButton,{"aria-label":"settings","aria-describedby":q,onClick:function(e){var t=window.innerWidth-175,n=window.innerHeight-175;N?N&&(M(!1),G("100%"),U("100%"),j(null)):(M(!0),G(t),U(n),j(null))},size:"small",children:N?(0,Z.jsx)(le.Z,{}):(0,Z.jsx)(se.Z,{})}),(0,Z.jsx)(w.IconButton,{"aria-label":"settings","aria-describedby":q,onClick:o,size:"small",children:(0,Z.jsx)(ce.Z,{})}),(0,Z.jsx)(w.IconButton,{"aria-label":"settings","aria-describedby":q,className:Y.button,onClick:function(e){j(e.currentTarget)},size:"small",children:(0,Z.jsx)(oe.Z,{})}),(0,Z.jsx)(w.Popover,{id:q,open:X,anchorEl:I,onClose:function(){j(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,Z.jsxs)(w.ListItem,{button:!0,onClick:o,children:[(0,Z.jsx)(w.ListItemIcon,{children:(0,Z.jsx)(ce.Z,{})}),(0,Z.jsx)(w.ListItemText,{primary:"Fermer"})]})})]}),title:"Place de march\xe9",subheader:"Liste des applications BIM"}),(0,Z.jsxs)(w.CardContent,{className:Y.cardContent,children:["home"===x&&(0,Z.jsxs)(w.Grid,{container:!0,spacing:3,children:[(null===S||void 0===S?void 0:S.length)>=0&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(we,{input:T,onChange:function(e){var t=[].concat(st);if(t&&t.length>0){var n=t.filter((function(t){return"".concat(t.name," ").concat(t.type," ").concat(t.description).toLowerCase().includes(e.toLowerCase())}));F(e),k(n)}},placeholder:"Key words"})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(w.Typography,{children:"Number of results: ".concat(S.length)})})]}),null===S||void 0===S?void 0:S.map((function(e){return(0,Z.jsx)(w.Grid,{item:!0,xs:4,children:(0,Z.jsx)(w.Card,{className:Y.application,children:(0,Z.jsxs)(w.CardActionArea,{onClick:function(){g(e.name)},children:[(0,Z.jsx)(w.CardHeader,{avatar:(0,Z.jsx)(w.Avatar,{"aria-label":"recipe",className:Y.avatar,src:e.img,alt:e.name,title:e.name}),title:e.name,subheader:(0,Z.jsx)(w.Badge,{color:"success",pill:!0,children:e.type})}),(0,Z.jsx)(w.CardContent,{children:(0,Z.jsx)(w.Typography,{variant:"body2",color:"textSecondary",component:"p",children:e.description})})]})})})}))]}),"Open dthX"===x&&(0,Z.jsx)(qe,{bimData:t,setBimData:n,viewer:a,modelID:i,eids:c,setEids:s,addElementsNewProperties:d,handleShowMarketplace:o}),"DropBox"===x&&(0,Z.jsx)($e,{viewer:a,onDrop:l}),"Tracim"===x&&(0,Z.jsx)(ot,{viewer:a,onDrop:l})]})]})},dt=n(49374),ut=(n(18805),n(10306),n(73070)),pt=n(5508),ht=n(15391),ft=n.p+"8bde820ab92b00b56f5b.png",mt=JSON.parse('{"IfcProduct":"\ue047","IfcAnnotation":"\ue3c9","IfcElement":"\ue047","IfcBuildingElement":"\ue047","IfcBeam":"\uf108","IfcBuildingElementComponent":"\ue047","IfcBuildingElementPart":"\ue047","IfcReinforcingElement":"\ue047","IfcReinforcingBar":"\ue047","IfcReinforcingMesh":"\ue047","IfcTendon":"\ue047","IfcTendonAnchor":"\ue047","IfcBuildingElementProxy":"\ue047","IfcColumn":"\ue233","IfcCovering":"\ue047","IfcCurtainWall":"\ue047","IfcDoor":"\ueb4f","IfcFooting":"\uf200","IfcMember":"\ue047","IfcPile":"\ue047","IfcPlate":"\ue047","IfcRailing":"\ue58f","IfcRamp":"\ue86b","IfcRampFlight":"\ue86b","IfcRoof":"\uf201","IfcSlab":"\ue229","IfcStair":"\uf1a9","IfcStairFlight":"\uf1a9","IfcWall":"\ue3c0","IfcWallStandardCase":"\ue3c0","IfcWindow":"\uf088","IfcDistributionElement":"\ue047","IfcDistributionControlElement":"\ue047","IfcDistributionFlowElement":"\ue047","IfcDistributionChamberElement":"\ue047","IfcEnergyConversionDevice":"\ue047","IfcFlowController":"\ue047","IfcElectricDistributionPoint":"\ue047","IfcFlowFitting":"\ue047","IfcFlowMovingDevice":"\ue047","IfcFlowSegment":"\ue047","IfcFlowStorageDevice":"\ue047","IfcFlowTerminal":"\ue047","IfcFlowTreatmentDevice":"\ue047","IfcElectricalElement":"\ue047","IfcElementAssembly":"\ue9b0","IfcElementComponent":"\ue047","IfcDiscreteAccessory":"\ue047","IfcFastener":"\ue047","IfcMechanicalFastener":"\ue047","IfcEquipmentElement":"\ue047","IfcFeatureElement":"\ue047","IfcFeatureElementAddition":"\ue047","IfcProjectionElement":"\ue047","IfcFeatureElementSubtraction":"\ue047","IfcEdgeFeature":"\ue047","IfcChamferEdgeFeature":"\ue047","IfcRoundedEdgeFeature":"\ue047","IfcOpeningElement":"\ue3c6","IfcFurnishingElement":"\uea45","IfcTransportElement":"\uf1a0","IfcVirtualElement":"\ue047","IfcGrid":"\uf015","IfcPort":"\ue8c0","IfcDistributionPort":"\ue8c0","IfcProxy":"\ue047","IfcSpatialStructureElement":"\ue047","IfcBuilding":"\uea40","IfcBuildingStorey":"\ue8fe","IfcSite":"\ue80b","IfcSpace":"\ueff4","IfcStructuralActivity":"\ue047","IfcStructuralAction":"\ue047","IfcStructuralLinearAction":"\ue047","IfcStructuralLinearActionVarying":"\ue047","IfcStructuralPlanarAction":"\ue047","IfcStructuralPlanarActionVarying":"\ue047","IfcStructuralPointAction":"\ue047","IfcStructuralReaction":"\ue047","IfcStructuralPointReaction":"\ue047","IfcStructuralItem":"\ue047","IfcStructuralConnection":"\ue047","IfcStructuralCurveConnection":"\ue047","IfcStructuralPointConnection":"\ue047","IfcStructuralSurfaceConnection":"\ue047","IfcStructuralMember":"\ue047","IfcStructuralCurveMember":"\ue047","IfcStructuralCurveMemberVarying":"\ue047","IfcStructuralSurfaceMember":"\ue047","IfcStructuralSurfaceMemberVarying":"\ue047","IfcBeamStandardCase":"\uf108","IfcChimney":"\ue047","IfcColumnStandardCase":"\ue233","IfcDoorStandardCase":"\ueb4f","IfcMemberStandardCase":"\ue047","IfcPlateStandardCase":"\ue047","IfcShadingDevice":"\ue047","IfcSlabElementedCase":"\ue229","IfcSlabStandardCase":"\ue229","IfcWallElementedCase":"\ue3c0","IfcWindowStandardCase":"\uf088","IfcCivilElement":"\uea99","IfcActuator":"\ue047","IfcAlarm":"\ue047","IfcController":"\ue047","IfcFlowInstrument":"\ue047","IfcProtectiveDeviceTrippingUnit":"\ue047","IfcSensor":"\ue51e","IfcUnitaryControlElement":"\ue047","IfcAirToAirHeatRecovery":"\ue047","IfcBoiler":"\ue047","IfcBurner":"\ue047","IfcChiller":"\ue047","IfcCoil":"\ue047","IfcCondenser":"\ue047","IfcCooledBeam":"\ue047","IfcCoolingTower":"\ue047","IfcElectricGenerator":"\ue047","IfcElectricMotor":"\ue047","IfcEngine":"\ue047","IfcEvaporativeCooler":"\ue047","IfcEvaporator":"\ue047","IfcHeatExchanger":"\ue047","IfcHumidifier":"\ue047","IfcMotorConnection":"\ue047","IfcSolarDevice":"\ue047","IfcTransformer":"\ue047","IfcTubeBundle":"\ue047","IfcUnitaryEquipment":"\ue047","IfcAirTerminalBox":"\ue047","IfcDamper":"\ue047","IfcElectricDistributionBoard":"\ue047","IfcElectricTimeControl":"\ue047","IfcFlowMeter":"\ue047","IfcProtectiveDevice":"\ue047","IfcSwitchingDevice":"\ue047","IfcValve":"\ue047","IfcCableCarrierFitting":"\ue047","IfcCableFitting":"\ue047","IfcDuctFitting":"\ue047","IfcJunctionBox":"\ue047","IfcPipeFitting":"\ue047","IfcCompressor":"\ue047","IfcFan":"\ue047","IfcPump":"\ue047","IfcCableCarrierSegment":"\ue047","IfcCableSegment":"\ue047","IfcDuctSegment":"\ue047","IfcPipeSegment":"\ue047","IfcElectricFlowStorageDevice":"\ue047","IfcTank":"\ue047","IfcAirTerminal":"\uefd8","IfcAudioVisualAppliance":"\ue333","IfcCommunicationsAppliance":"\ue047","IfcElectricAppliance":"\ue047","IfcFireSuppressionTerminal":"\ue047","IfcLamp":"\uf02a","IfcLightFixture":"\uf02a","IfcMedicalDevice":"\ue047","IfcOutlet":"\ue047","IfcSanitaryTerminal":"\uea41","IfcSpaceHeater":"\uf076","IfcStackTerminal":"\ue047","IfcWasteTerminal":"\ue047","IfcDuctSilencer":"\ue047","IfcFilter":"\ue047","IfcInterceptor":"\ue047","IfcVibrationIsolator":"\ue047","IfcOpeningStandardCase":"\ue3c6","IfcVoidingFeature":"\ue047","IfcSurfaceFeature":"\ue047","IfcFurniture":"\uea45","IfcSystemFurnitureElement":"\uea45","IfcGeographicElement":"\uea99","IfcSpatialElement":"\ue047","IfcExternalSpatialStructureElement":"\ue047","IfcExternalSpatialElement":"\ue047","IfcSpatialZone":"\ue047","IfcStructuralCurveAction":"\ue047","IfcStructuralSurfaceAction":"\ue047","IfcStructuralCurveReaction":"\ue047","IfcStructuralSurfaceReaction":"\ue047","IfcContext":"\uf1c4","IfcProject":"\uf1c4","IfcProjectLibrary":"\uf1c4"}'),xt=n(91592),gt=n.n(xt),vt=n(63437),bt=(0,w.makeStyles)((function(e){return{heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},table:{width:"100%"},cardInfo:{zIndex:100,width:"100%",height:"100%"},cardContent:{height:"90%",overflowY:"auto",overflowX:"hidden","&::-webkit-scrollbar":{width:"0.4em"},"&::-webkit-scrollbar-track":{"-webkit-box-shadow":"inset 0 0 6px rgba(0,0,0,0.00)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.1)",outline:"0px solid slategrey"}},treeViewLabel:{left:"3em",position:"absolute",textOverflow:"ellipsis",overflow:"hidden",wordWrap:"break-word",warp:!0},treeViewCheckbox:{margin:0,padding:0},treeView:{flexGrow:1},buttonGroup:{backgroundColor:"white",marginTop:"1em"}}})),It=function(e){var t=e.bimData,n=e.setBimData,i=e.viewer,o=e.handleShowMarketplace,c=e.handleShowProperties,s=e.handleGetJsonData,l=e.eids,d=e.setEids,u=bt(),p=(0,r.useState)(0),h=(0,m.Z)(p,2),f=(h[0],h[1],a().useState([0])),g=(0,m.Z)(f,2),v=g[0],b=g[1],I=(0,r.useState)([]),w=(0,m.Z)(I,2),j=(w[0],w[1]),y=(0,r.useState)(""),C=(0,m.Z)(y,2),S=C[0],k=C[1],E=(0,r.useState)([]),D=(0,m.Z)(E,2),B=D[0],A=D[1],L=(0,r.useState)({loading:!1,message:"".concat(B.length," \xe9l\xe9ments")}),N=(0,m.Z)(L,2),M=N[0],R=N[1];(0,r.useEffect)((function(){function e(){return e=(0,P.Z)((0,F.Z)().mark((function e(){var t;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R({loading:!0,message:"Chargement de la s\xe9lection..."}),e.next=3,Promise.all(l.map(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.IFC.getProperties(0,t,!1,!1);case 2:return n=e.sent,e.next=5,i.IFC.loader.ifcManager.getIfcType(0,t);case 5:return e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:t=e.sent,A(t),R({loading:!1,message:"".concat(t.length," \xe9l\xe9ments")});case 6:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[l]);var _=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=v.indexOf(t),r=(0,T.Z)(v),-1===n?r.push(n):r.splice(n,1),b(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d([]),e.next=3,i.IFC.unpickIfcItems();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.filter((function(e){return e!==t.expressID})),e.next=3,i.IFC.pickIfcItemsByID(0,n);case 3:d(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(e){var t=e.data,n=e.fileName,r=e.fileType,a=new Blob([t],{type:r}),i=document.createElement("a");i.download=n,i.href=window.URL.createObjectURL(a);var o=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});i.dispatchEvent(o),i.remove()},H=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t,n){var r,a;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r=[],a=["modelId","elementName","elementClass","globalId","expressId","psetName","propertyName","propertyValue"].join(","),r.push(a),e.next=6,Promise.all(n.map(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,a;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.IFC.getProperties(0,t,!0,!0);case 2:return a=e.sent,e.next=5,i.IFC.getModelID();case 5:return e.sent,console.log("ifcClass ",a),e.next=9,Promise.all(null===(n=a.psets)||void 0===n?void 0:n.map(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.HasProperties,!e.t0){e.next=5;break}return e.next=4,Promise.all(null===(n=t.HasProperties)||void 0===n?void 0:n.map(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(n){var i,o,c,s,l,d,u,p,h,f,m;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=0,l="".concat(null===(i=a.Name)||void 0===i?void 0:i.value),d="NONE",u="".concat(a.GlobalId.value),p="".concat(a.expressID),h="".concat(t.Name.value),f="".concat(null===(o=n.Name)||void 0===o?void 0:o.value),m="".concat(null===(c=n.NominalValue)||void 0===c?void 0:c.value),r.push([s,l,d,u,p,h,f,m].join(","));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:e.t0=e.sent;case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:z({data:[].concat(r).join("\n"),fileName:"selection.csv",fileType:"text/csv"});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();var V=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(r){var a,o,c,l;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(R({loading:!0,message:"Chargement..."}),console.log("inputs",r),a=t.search.data[0],console.log("dataList",a),a&&0!==a.length){e.next=10;break}return e.next=7,s(i,gt()(t.spatialStructures.list[0],"children"),R);case 7:o=e.sent,n((0,x.Z)((0,x.Z)({},t),{},{search:(0,x.Z)((0,x.Z)({},t.search),{},{data:[].concat((0,T.Z)(t.search.data),[o])})})),a=(0,T.Z)(o);case 10:if(c=[],!(a&&a.length>0)){e.next=22;break}return e.next=14,a.filter((function(e){var t=U(e,r);return t&&c.push(e.expressID),t}));case 14:return l=e.sent,k(r),j(l),d(c),console.log("newFilteredData",l),A(l),e.next=22,i.IFC.pickIfcItemsByID(0,c);case 22:R({loading:!1,message:"".concat(c.length," \xe9l\xe9ments")});case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var U=function(e,t){var n,r,a,i=[];return i.push("".concat(null===(n=e.Name)||void 0===n?void 0:n.value," ").concat(e.type," ").concat(e.Description," ").concat(null===(r=e.GlobalId)||void 0===r?void 0:r.value," ").concat(null===(a=e.ObjectType)||void 0===a?void 0:a.value," ").concat(e.expressID)),i.some((function(e){return e.toLowerCase().includes(t.toLowerCase())}))},Y=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(""),d([]),A([]),e.next=5,i.IFC.pickIfcItemsByID(0,[]);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,Z.jsxs)(ie.Grid,{container:!0,spacing:1,children:[(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:(0,Z.jsx)(we,{input:S,style:{marginBottom:"1em"},onChange:function(e){k(e)},placeholder:"Mot cl\xe9",onClickOne:function(){return V(S)},onClickTwo:Y})}),(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:(0,Z.jsx)(ie.Typography,{gutterBottom:!0,variant:"title2",component:"div",children:"Remarque: La premi\xe8re recherche par mot cl\xe8s peut \xeatre longue car elle g\xe9n\xe8re les donn\xe9es pour la recherche."})}),(0,Z.jsx)(ie.Grid,{item:!0,xs:6,style:{textAlign:"left"},children:(0,Z.jsx)(ie.ButtonGroup,{className:u.buttonGroup,children:(0,Z.jsx)(ie.Button,{edge:"end","aria-label":"comments",onClick:O,children:(0,Z.jsx)(ht.Z,{})})})}),(0,Z.jsx)(ie.Grid,{item:!0,xs:6,style:{textAlign:"right"},children:(0,Z.jsxs)(ie.ButtonGroup,{className:u.buttonGroup,children:[(0,Z.jsx)(ie.Button,{edge:"end","aria-label":"comments",className:u.button,onClick:function(e){return H(e,l)},children:(0,Z.jsx)(ut.Z,{})}),(0,Z.jsx)(ie.Button,{edge:"end","aria-label":"comments",onClick:function(){return o("Open dthX")},children:(0,Z.jsx)(ie.Avatar,{"aria-label":"recipe",className:u.avatar,src:ft,style:{width:"1em",height:"auto"}})})]})}),(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:M.loading?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(ie.Grid,{item:!0,xs:12,style:{textAlign:"center"},children:(0,Z.jsx)(ie.CircularProgress,{color:"inherit"})}),(0,Z.jsx)(ie.Grid,{item:!0,xs:12,justify:"center",style:{textAlign:"center"},children:(0,Z.jsxs)(ie.Typography,{gutterBottom:!0,variant:"h5",component:"div",children:["".concat(M.message),"    "]})})]}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:(0,Z.jsxs)(ie.Typography,{gutterBottom:!0,variant:"title",component:"div",children:["".concat(M.message),"    "]})}),(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:(0,Z.jsx)(vt.FixedSizeList,{width:"100%",height:700,itemCount:B.length,itemSize:30,children:function(e){var t=e.index,n=e.key,r=e.style;return(0,Z.jsx)(ie.ListItem,{secondaryAction:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(ie.IconButton,{edge:"end","aria-label":"comments",onClick:function(e){c(B[t].expressID),e.stopPropagation()},children:(0,Z.jsx)(W.Z,{})}),(0,Z.jsx)(ie.IconButton,{edge:"end","aria-label":"comments",onClick:function(e){return H(e,[B[t].expressID])},children:(0,Z.jsx)(ut.Z,{})}),(0,Z.jsx)(ie.IconButton,{edge:"end","aria-label":"comments",onClick:function(){return G(B[t])},children:(0,Z.jsx)(pt.Z,{})})]}),disablePadding:!0,style:r,children:(0,Z.jsx)(ie.ListItemButton,{role:void 0,dense:!0,onClick:function(){return _(B[t])},children:(0,Z.jsx)(ie.ListItemText,{id:"checkbox-list-label-".concat(t),primary:"".concat(B[t].Name?B[t].Name.value:"NO NAME"," / ").concat(B[t].expressID)})})},n)}})})]})})]})},wt=(0,r.memo)(It),jt=n(40376),yt=n.p+"8bde820ab92b00b56f5b.png",Ct=n(49346),Zt=n(39005),St=n(68298),kt=n(77609),Et=n.n(kt),Dt=n(26570),Tt=function(e){var t=(0,F.Z)().mark(f),n=e.spatialStructures,a=(e.spatialStructure,e.handleShowProperties),i=e.toggleRow,o=e.vtree,c=(0,r.useState)(!1),s=(0,m.Z)(c,2),l=s[0],d=s[1],u=(0,r.useRef)();(0,r.useEffect)((function(){setTimeout((function(){var e;null===(e=u.current)||void 0===e||e.recomputeTree(o)}),1)}),[l,o]);var p=function(e){var t=e.data,n=t.isLeaf,r=t.type,c=t.id,s=t.nestingLevel,l=t.name,d=e.isOpen,u=e.style,p=e.setOpen;e.exportNodeToCsv;return(0,Z.jsxs)("div",{style:(0,x.Z)((0,x.Z)({},u),{},{alignItems:"center",display:"flex",marginLeft:20*s+(n?48:0)}),children:[!n&&(0,Z.jsx)("span",{onClick:function(){return p(!d)},children:d?(0,Z.jsx)(Ct.Z,{}):(0,Z.jsx)(Zt.Z,{})}),(0,Z.jsx)(ie.Checkbox,{type:"checkbox",name:"scales",defaultChecked:o[c],onClick:function(){return i(c)}}),(0,Z.jsx)(ie.Chip,{label:"".concat(r)}),(0,Z.jsx)(ie.Typography,{component:"div",children:"/".concat(l.toLowerCase(),"/").concat(c)}),(0,Z.jsx)(ie.Grid,{item:!0,xs:2,sx:{textAlign:"right"},children:(0,Z.jsx)(ie.IconButton,{edge:"end","aria-label":"comments",onClick:function(e){a(parseInt(c))},children:(0,Z.jsx)(St.Z,{})})})]})},h=function(e,t,n){return{data:{id:e.expressID.toString(),isLeaf:0===e.children.length,isOpenByDefault:!1,type:e.type,name:e.Name?e.Name.value:"",nestingLevel:t},nestingLevel:t,node:e}};function f(){var e,r,a;return(0,F.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=0;case 1:if(!(e<n.length)){t.next=7;break}return t.next=4,h(n[e],0);case 4:e++,t.next=1;break;case 7:return void(t.next=10);case 10:r=t.sent,a=0;case 12:if(!(a<r.node.children.length)){t.next=18;break}return t.next=15,h(r.node.children[a],r.nestingLevel+1);case 15:a++,t.next=12;break;case 18:t.next=7;break;case 20:case"end":return t.stop()}}),t)}return(0,Z.jsx)(Et(),{children:function(e){var t=e.height,n=e.width;return(0,Z.jsx)(Dt.FixedSizeTree,{ref:function(e){u.current=e,d(!!e)},itemCount:1e3,itemSize:30,treeWalker:f,height:t,width:n,children:p})}})};var Ft=function(e,t){switch(t.type){case"LOAD_DATA":var n=t.payload,r=n.originalStructureTree,a=n.hashMapTree,i=n.vtree,o=n.selected;return(0,x.Z)((0,x.Z)({},e),{},{spatialStructures:r,hashMapTree:a,vtree:i,selected:o,loading:!1});case"SET_EXPANDED":return(0,x.Z)((0,x.Z)({},e),{},{expanded:t.payload,loading:!1,loadingCursor:!1});case"SELECT_CHILDREN":var c=t.payload,s=c.selected,l=c.vtree;return(0,x.Z)((0,x.Z)({},e),{},{selected:s,vtree:l,expanded:null,loading:!1});case"RESET_TREE":return(0,x.Z)((0,x.Z)({},e),{},{selected:[],vtree:{},expanded:null,loading:!1});case"LOADING":return(0,x.Z)((0,x.Z)({},e),{},{loading:!0});case"LOADING_CURSOR":return(0,x.Z)((0,x.Z)({},e),{},{loadingCursor:!0});default:throw new Error}},Pt=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return t.reduce((function(t,n){return t[n.expressID]=n,t[n.expressID].parentsIds=t[r]&&t[r].parentsIds?[].concat((0,T.Z)(t[r].parentsIds),[n.expressID]):[n.expressID],t[n.expressID].childrenIds=Bt([n.expressID],t[n.expressID]),n.children&&((t=e(n.children,t,n.expressID))[n.expressID].parentID=r),t}),n)};function Bt(e,t){var n=[e[0]];return function e(t){t.children&&t.children.length>0&&t.children.forEach((function(t){n.push(t.expressID),e(t)}))}(t),n}function At(e){return{originalStructureTree:e,hashMapTree:Pt(e,{})}}function Lt(e){return e.reduce((function(e,t){return e[t]={open:!0},e}),{})}function Nt(e,t,n,r){var a=t;if(e.length>0)if(e.includes(parseInt(r))){var i=e.indexOf(parseInt(r));a=e.filter((function(e,t){return t!==i})).filter((function(e){return!n.includes(e)}))}else a=(0,T.Z)(new Set(e.concat([].concat((0,T.Z)(t),[parseInt(r)]))));return a}function Mt(e,t){return Rt.apply(this,arguments)}function Rt(){return(Rt=(0,P.Z)((0,F.Z)().mark((function e(t,n){var r;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.map((function(e){return parseInt(e,10)})),e.next=3,n.IFC.pickIfcItemsByID(0,r);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _t=(0,w.makeStyles)((function(e){return{heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},table:{width:"100%"},cardInfo:{zIndex:100,width:"100%",height:"100%"},cardContent:{height:"90%",overflowY:"auto",overflowX:"hidden","&::-webkit-scrollbar":{width:"0.4em"},"&::-webkit-scrollbar-track":{"-webkit-box-shadow":"inset 0 0 6px rgba(0,0,0,0.00)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.1)",outline:"0px solid slategrey"}},treeViewLabel:{left:"3em",position:"absolute",textOverflow:"ellipsis",overflow:"hidden",wordWrap:"break-word",warp:!0},treeViewCheckbox:{margin:0,padding:0},treeView:{flexGrow:1}}})),Ot=function(e){var t=e.tree,n=e.viewer,a=e.handleShowMarketplace,i=e.handleShowProperties,o=e.eids,c=e.setEids,s=(0,r.useReducer)(Ft,{loading:!0,loadingCursor:!1,selected:[],expanded:[],hashMapTree:{},vtree:{}}),l=(0,m.Z)(s,2),d=l[0],u=d.spatialStructures,p=d.loading,h=d.selected,f=d.hashMapTree,x=d.vtree,g=l[1],v=(0,r.useRef)(h),b=_t();(0,r.useEffect)((function(){v.current=h}),[h]),(0,r.useEffect)((function(){return function(){var e=v.current.map((function(e){return parseInt(e)}));c(e)}}),[]),(0,r.useEffect)((function(){!function(e){return function(t,n){var r=At(t),a=r.originalStructureTree,i=r.hashMapTree,o=n;if(1===n.length){var c=i[n[0]],s=null!==c&&void 0!==c?c:{childrenIds:[],parentsIds:[]},l=s.childrenIds,d=s.parentsIds;o=[].concat((0,T.Z)(n),(0,T.Z)(l),(0,T.Z)(d))}var u=Lt(o);e({type:"LOAD_DATA",payload:{originalStructureTree:a,hashMapTree:i,vtree:u,selected:o}})}}(g)(t,o)}),[o]);var I=function(e){var t=e.data,n=e.fileName,r=e.fileType,a=new Blob([t],{type:r}),i=document.createElement("a");i.download=n,i.href=window.URL.createObjectURL(a);var o=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});i.dispatchEvent(o),i.remove()},w=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t,r){var a,i;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=[],i=["modelId","elementName","elementClass","globalId","expressId","psetName","propertyName","propertyValue"].join(","),a.push(i),e.next=6,Promise.all(r.map(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var r,i,o;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.IFC.getProperties(0,t,!0,!0);case 2:return i=e.sent,e.next=5,n.IFC.getModelID();case 5:return e.sent,new jt.F,e.next=9,n.IFC.loader.ifcManager.getIfcType(0,t);case 9:return o=e.sent,e.t0=console,e.next=13,n.IFC.loader.ifcManager.getIfcType(0,t);case 13:return e.t1=e.sent,e.t0.log.call(e.t0,"ifcClass",e.t1),e.next=17,Promise.all(null===(r=i.psets)||void 0===r?void 0:r.map(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.HasProperties,!e.t0){e.next=5;break}return e.next=4,Promise.all(null===(n=t.HasProperties)||void 0===n?void 0:n.map(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(n){var r,c,s,l,d,u,p,h,f,m,x;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=0,d="".concat(null===(r=i.Name)||void 0===r?void 0:r.value),u=o||"NONE",p="".concat(i.GlobalId.value),h="".concat(i.expressID),f="".concat(t.Name.value),m="".concat(null===(c=n.Name)||void 0===c?void 0:c.value),x="".concat(null===(s=n.NominalValue)||void 0===s?void 0:s.value),a.push([l,d,u,p,h,f,m,x].join(","));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:e.t0=e.sent;case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:I({data:[].concat(a).join("\n"),fileName:"selection.csv",fileType:"text/csv"});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function j(e){!function(e){return function(){var t=(0,P.Z)((0,F.Z)().mark((function t(n,r,a,i){var o,c,s,l,d,u,p,h;return(0,F.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=null!==(o=r[a])&&void 0!==o?o:{childrenIds:[],parentsIds:[]},s=c.childrenIds,l=c.parentsIds,d=[].concat((0,T.Z)(l),(0,T.Z)(s)),u=Nt(n,d,s,a),p=u.map((function(e){return e.toString()})),h=Lt(p),t.next=8,Mt(p,i);case 8:e({type:"SELECT_CHILDREN",payload:{selected:u,vtree:h}});case 9:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}()}(g)(h,f,e,n)}function y(){!function(e){return function(){var t=(0,P.Z)((0,F.Z)().mark((function t(n){return(0,F.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.IFC.unpickIfcItems();case 2:e({type:"RESET_TREE"});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(g)(n)}return(0,Z.jsxs)(ie.Grid,{container:!0,children:[(0,Z.jsx)(ie.Grid,{xs:6,style:{textAlign:"left"},children:(0,Z.jsx)(ie.ButtonGroup,{className:b.buttonGroup,children:(0,Z.jsx)(ie.Button,{edge:"end","aria-label":"comments",onClick:function(){return y()},children:(0,Z.jsx)(ht.Z,{})})})}),(0,Z.jsx)(ie.Grid,{xs:6,style:{textAlign:"right"},children:(0,Z.jsxs)(ie.ButtonGroup,{className:b.buttonGroup,children:[(0,Z.jsx)(ie.Button,{edge:"end","aria-label":"comments",className:b.button,onClick:function(e){return w(e,o)},children:(0,Z.jsx)(ut.Z,{})}),(0,Z.jsx)(ie.Button,{edge:"end","aria-label":"comments",onClick:function(){return a("Open dthX")},children:(0,Z.jsx)(ie.Avatar,{"aria-label":"recipe",className:b.avatar,src:yt,style:{width:"1em",height:"auto"}})})]})}),p?(0,Z.jsx)(ie.Grid,{item:!0,xs:12,justify:"center",style:{textAlign:"center"},children:(0,Z.jsx)(ie.CircularProgress,{color:"inherit"})}):(0,Z.jsx)("div",{style:{display:"flex",width:"100%"},children:u&&u.length&&u.map((function(e){return(0,Z.jsx)("div",{style:{flex:"1 1 auto",height:"300px"},children:(0,Z.jsx)(Tt,{spatialStructures:u,spatialStructure:e,handleShowProperties:i,toggleRow:j,vtree:x})},e.expressID)}))})]})},Gt=n.p+"8bde820ab92b00b56f5b.png",Wt=["IfcProduct","IfcAnnotation","IfcElement","IfcBuildingElement","IfcBeam","IfcBuildingElementComponent","IfcBuildingElementPart","IfcReinforcingElement","IfcReinforcingBar","IfcReinforcingMesh","IfcTendon","IfcTendonAnchor","IfcBuildingElementProxy","IfcColumn","IfcCovering","IfcCurtainWall","IfcDoor","IfcFooting","IfcMember","IfcPile","IfcPlate","IfcRailing","IfcRamp","IfcRampFlight","IfcRoof","IfcSlab","IfcStair","IfcStairFlight","IfcWall","IfcWallStandardCase","IfcWindow","IfcDistributionElement","IfcDistributionControlElement","IfcDistributionFlowElement","IfcDistributionChamberElement","IfcEnergyConversionDevice","IfcFlowController","IfcElectricDistributionPoint","IfcFlowFitting","IfcFlowMovingDevice","IfcFlowSegment","IfcFlowStorageDevice","IfcFlowTerminal","IfcFlowTreatmentDevice","IfcElectricalElement","IfcElementAssembly","IfcElementComponent","IfcDiscreteAccessory","IfcFastener","IfcMechanicalFastener","IfcEquipmentElement","IfcFeatureElement","IfcFeatureElementAddition","IfcProjectionElement","IfcFeatureElementSubtraction","IfcEdgeFeature","IfcChamferEdgeFeature","IfcRoundedEdgeFeature","IfcOpeningElement","IfcFurnishingElement","IfcTransportElement","IfcVirtualElement","IfcGrid","IfcPort","IfcDistributionPort","IfcProxy","IfcSpatialStructureElement","IfcBuilding","IfcBuildingStorey","IfcSite","IfcSpace","IfcStructuralActivity","IfcStructuralAction","IfcStructuralLinearAction","IfcStructuralLinearActionVarying","IfcStructuralPlanarAction","IfcStructuralPlanarActionVarying","IfcStructuralPointAction","IfcStructuralReaction","IfcStructuralPointReaction","IfcStructuralItem","IfcStructuralConnection","IfcStructuralCurveConnection","IfcStructuralPointConnection","IfcStructuralSurfaceConnection","IfcStructuralMember","IfcStructuralCurveMember","IfcStructuralCurveMemberVarying","IfcStructuralSurfaceMember","IfcStructuralSurfaceMemberVarying","IfcBeamStandardCase","IfcChimney","IfcColumnStandardCase","IfcDoorStandardCase","IfcMemberStandardCase","IfcPlateStandardCase","IfcShadingDevice","IfcSlabElementedCase","IfcSlabStandardCase","IfcWallElementedCase","IfcWindowStandardCase","IfcCivilElement","IfcActuator","IfcAlarm","IfcController","IfcFlowInstrument","IfcProtectiveDeviceTrippingUnit","IfcSensor","IfcUnitaryControlElement","IfcAirToAirHeatRecovery","IfcBoiler","IfcBurner","IfcChiller","IfcCoil","IfcCondenser","IfcCooledBeam","IfcCoolingTower","IfcElectricGenerator","IfcElectricMotor","IfcEngine","IfcEvaporativeCooler","IfcEvaporator","IfcHeatExchanger","IfcHumidifier","IfcMotorConnection","IfcSolarDevice","IfcTransformer","IfcTubeBundle","IfcUnitaryEquipment","IfcAirTerminalBox","IfcDamper","IfcElectricDistributionBoard","IfcElectricTimeControl","IfcFlowMeter","IfcProtectiveDevice","IfcSwitchingDevice","IfcValve","IfcCableCarrierFitting","IfcCableFitting","IfcDuctFitting","IfcJunctionBox","IfcPipeFitting","IfcCompressor","IfcFan","IfcPump","IfcCableCarrierSegment","IfcCableSegment","IfcDuctSegment","IfcPipeSegment","IfcElectricFlowStorageDevice","IfcTank","IfcAirTerminal","IfcAudioVisualAppliance","IfcCommunicationsAppliance","IfcElectricAppliance","IfcFireSuppressionTerminal","IfcLamp","IfcLightFixture","IfcMedicalDevice","IfcOutlet","IfcSanitaryTerminal","IfcSpaceHeater","IfcStackTerminal","IfcWasteTerminal","IfcDuctSilencer","IfcFilter","IfcInterceptor","IfcVibrationIsolator","IfcOpeningStandardCase","IfcVoidingFeature","IfcSurfaceFeature","IfcFurniture","IfcSystemFurnitureElement","IfcGeographicElement","IfcSpatialElement","IfcExternalSpatialStructureElement","IfcExternalSpatialElement","IfcSpatialZone","IfcStructuralCurveAction","IfcStructuralSurfaceAction","IfcStructuralCurveReaction","IfcStructuralSurfaceReaction","IfcContext","IfcProject","IfcProjectLibrary"],zt=(0,w.makeStyles)((function(e){return{heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},table:{width:"100%"},cardInfo:{zIndex:100,width:"100%",height:"100%"},cardContent:{height:"90%",overflowY:"auto",overflowX:"hidden","&::-webkit-scrollbar":{width:"0.4em"},"&::-webkit-scrollbar-track":{"-webkit-box-shadow":"inset 0 0 6px rgba(0,0,0,0.00)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.1)",outline:"0px solid slategrey"}},treeViewLabel:{left:"3em",position:"absolute",textOverflow:"ellipsis",overflow:"hidden",wordWrap:"break-word",warp:!0},treeViewCheckbox:{margin:0,padding:0},treeView:{flexGrow:1},buttonGroup:{backgroundColor:"white",marginTop:"1em"}}})),Ht=function(e){var t=e.viewer,n=e.handleShowMarketplace,i=(e.handleShowProperties,e.eids),o=e.setEids,c=zt(),s=(0,r.useState)(0),l=(0,m.Z)(s,2),d=(l[0],l[1],a().useState([0])),u=(0,m.Z)(d,2),p=(u[0],u[1],(0,r.useState)([])),h=(0,m.Z)(p,2),f=h[0],x=h[1],g=(0,r.useState)([]),v=(0,m.Z)(g,2);v[0],v[1];(0,r.useEffect)((function(){function e(){return(e=(0,P.Z)((0,F.Z)().mark((function e(){var n,r,a,i,o;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Settings"),n=[],r=(0,Te.Z)(Wt),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=14;break}if(i=a.value,!B["".concat(i.toUpperCase())]){e.next=12;break}return e.next=10,t.getAllItemsOfType(0,B["".concat(i.toUpperCase())],!1,!1);case 10:(o=e.sent)&&o.length>0&&n.push({name:i,icon:mt["".concat(i)],eids:(0,T.Z)(o),hide:!1});case 12:e.next=5;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:x(n);case 23:case"end":return e.stop()}}),e,null,[[3,16,19,22]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[i]);var b=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(n){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(n),e.next=3,t.IFC.pickIfcItemsByID(0,n,!1,0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var I=function(e){var t=e.data,n=e.fileName,r=e.fileType,a=new Blob([t],{type:r}),i=document.createElement("a");i.download=n,i.href=window.URL.createObjectURL(a);var o=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});i.dispatchEvent(o),i.remove()},w=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(n,r){var a,i,o,c,s,l,d,u,p,h,f,m,x,g,v,b,w,j,y,C,Z,S,k;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),a=[],i=["modelId","elementName","elementClass","globalId","expressId","psetName","propertyName","propertyValue"].join(","),a.push(i),o=(0,Te.Z)(r.eids),e.prev=5,o.s();case 7:if((c=o.n()).done){e.next=16;break}return s=c.value,e.next=11,t.IFC.getProperties(0,s,!0,!0);case 11:if(l=e.sent,console.log("ifcElement",l),l&&l.psets&&l.psets.length>0){d=(0,Te.Z)(l.psets);try{for(d.s();!(u=d.n()).done;)if(p=u.value,console.log("pset",p),p.HasProperties&&p.HasProperties.length>0){h=(0,Te.Z)(p.HasProperties);try{for(h.s();!(f=h.n()).done;)v=f.value,console.log("property",v),b=0,w="".concat(null===(m=l.Name)||void 0===m?void 0:m.value),j="".concat(r.name),y="".concat(l.GlobalId.value),C="".concat(l.expressID),Z="".concat(p.Name.value),S="".concat(null===(x=v.Name)||void 0===x?void 0:x.value),k="".concat(null===(g=v.NominalValue)||void 0===g?void 0:g.value),a.push([b,w,j,y,C,Z,S,k].join(","))}catch(E){h.e(E)}finally{h.f()}}}catch(E){d.e(E)}finally{d.f()}}case 14:e.next=7;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),o.e(e.t0);case 21:return e.prev=21,o.f(),e.finish(21);case 24:I({data:[].concat(a).join("\n"),fileName:"".concat(r?r.name:"Undefined",".csv"),fileType:"text/csv"});case 25:case"end":return e.stop()}}),e,null,[[5,18,21,24]])})));return function(t,n){return e.apply(this,arguments)}}();return(0,Z.jsxs)(ie.Grid,{container:!0,children:[(0,Z.jsx)(ie.Grid,{item:!0,xs:6,style:{textAlign:"left"},children:(0,Z.jsx)(ie.ButtonGroup,{className:c.buttonGroup})}),(0,Z.jsx)(ie.Grid,{item:!0,xs:6,style:{textAlign:"right"},children:(0,Z.jsx)(ie.ButtonGroup,{className:c.buttonGroup,children:(0,Z.jsx)(ie.Button,{edge:"end","aria-label":"comments",onClick:function(){return n("Open dthX")},children:(0,Z.jsx)(ie.Avatar,{"aria-label":"recipe",className:c.avatar,src:Gt,style:{width:"1em",height:"auto"}})})})}),(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:(0,Z.jsx)(ie.List,{sx:{width:"100%"},children:f.map((function(e,t){return(0,Z.jsx)(ie.ListItem,{secondaryAction:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(ie.IconButton,{edge:"end","aria-label":"comments",onClick:function(t){return w(t,e)},children:(0,Z.jsx)(ut.Z,{})})}),disablePadding:!0,children:(0,Z.jsxs)(ie.ListItemButton,{role:void 0,dense:!0,onClick:function(){return b(e.eids)},children:[(0,Z.jsx)(ie.ListItemIcon,{children:(0,Z.jsx)(ie.Badge,{badgeContent:"".concat(e.eids.length),color:"primary",children:(0,Z.jsx)("i",{class:"material-icons",children:"".concat(e.icon)})})}),(0,Z.jsx)(ie.ListItemText,{id:"checkbox-list-label-".concat(t),primary:"".concat(e.name)})]})},t)}))})})]})},Vt=["children","value","index"],Ut=(0,w.makeStyles)((function(e){return{heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},table:{width:"100%"},cardExpanded:{position:"absolute",top:"0px",zIndex:1e3,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},card:{position:"absolute",top:"0px",zIndex:100,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},cardContent:{opacity:"0.95",height:"90%",overflowY:"auto",overflowX:"hidden","&::-webkit-scrollbar":{width:"0.4em"},"&::-webkit-scrollbar-track":{"-webkit-box-shadow":"inset 0 0 6px rgba(0,0,0,0.00)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.1)",outline:"0px solid slategrey"}},treeViewLabel:{left:"3em",position:"absolute",textOverflow:"ellipsis",overflow:"hidden",wordWrap:"break-word",warp:!0},treeViewCheckbox:{margin:0,padding:0},treeView:{flexGrow:1},avatar:{backgroundColor:"transparent"},fab:{backgroundColor:"white"},MuiButtonBase:{defaultProps:{disableRipple:!0}}}}));function Yt(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}var Xt=function(e){var t=e.state,n=e.setState,a=e.viewer,i=e.handleShowSpatialStructure,o=e.handleShowMarketplace,c=e.handleShowProperties,s=e.handleGetJsonData,l=e.eids,d=e.setEids,u=(0,r.useState)(null),p=(0,m.Z)(u,2),h=p[0],f=p[1],g=(0,r.useState)(0),v=(0,m.Z)(g,2),b=v[0],I=v[1],w=(0,r.useState)([]),j=(0,m.Z)(w,2),y=(j[0],j[1],(0,r.useState)([])),C=(0,m.Z)(y,2),S=(C[0],C[1],(0,r.useState)(!1)),k=(0,m.Z)(S,2),E=k[0],D=k[1],T=(0,r.useState)("100%"),F=(0,m.Z)(T,2),P=F[0],B=F[1],A=(0,r.useState)("100%"),L=(0,m.Z)(A,2),N=L[0],M=L[1],R=Ut({width:P,height:N});(0,r.useEffect)((function(){var e=function(){E||(B(window.innerWidth-175),M(window.innerHeight-175))};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]);var _=Boolean(h),O=_?"simple-popover":void 0;return(0,Z.jsxs)(ie.Card,{className:E?R.cardExpanded:R.card,children:[(0,Z.jsx)(ie.CardHeader,{avatar:(0,Z.jsx)(ie.Avatar,{"aria-label":"recipe",className:R.avatar,children:(0,Z.jsx)(ie.Fab,{size:"small",className:R.fab,children:(0,Z.jsx)(G.Z,{})})}),action:(0,Z.jsxs)("div",{children:[(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":O,onClick:function(e){var t=window.innerWidth-175,n=window.innerHeight-175;E?E&&(D(!1),B("100%"),M("100%"),f(null)):(D(!0),B(t),M(n),f(null))},size:"small",children:E?(0,Z.jsx)(le.Z,{}):(0,Z.jsx)(se.Z,{})}),(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":O,onClick:i,size:"small",children:(0,Z.jsx)(ce.Z,{})}),(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":O,onClick:function(e){f(e.currentTarget)},size:"small",children:(0,Z.jsx)(oe.Z,{})}),(0,Z.jsx)(ie.Popover,{id:O,open:_,anchorEl:h,onClose:function(){f(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,Z.jsxs)(ie.ListItem,{button:!0,onClick:i,children:[(0,Z.jsx)(ie.ListItemIcon,{children:(0,Z.jsx)(ce.Z,{})}),(0,Z.jsx)(ie.ListItemText,{primary:"Fermer"})]})})]}),title:"Centre d'informations",subheader:"Espace de recherche et mise \xe0 jour des donn\xe9es"}),(0,Z.jsxs)(ie.CardContent,{className:R.cardContent,children:[(0,Z.jsx)(ie.Box,{sx:{borderBottom:1,borderColor:"divider"},children:(0,Z.jsxs)(ie.Tabs,{value:b,onChange:function(e,t){I(t)},"aria-label":"basic tabs example",children:[(0,Z.jsx)(ie.Tab,(0,x.Z)({label:"S\xe9lection"},Yt(0))),(0,Z.jsx)(ie.Tab,(0,x.Z)({label:"Structure spatiale"},Yt(1))),(0,Z.jsx)(ie.Tab,(0,x.Z)({label:"Classes"},Yt(2)))]})}),(0,Z.jsx)(qt,{value:b,index:0,children:(0,Z.jsx)(wt,{bimData:t,setBimData:n,viewer:a,handleShowMarketplace:o,handleShowProperties:c,handleGetJsonData:s,eids:l,setEids:d})}),(0,Z.jsx)(qt,{value:b,index:1,children:(0,Z.jsx)(Ot,{tree:t.spatialStructures.list,viewer:a,handleShowMarketplace:o,handleShowProperties:c,eids:l,setEids:d})}),(0,Z.jsx)(qt,{value:b,index:2,children:(0,Z.jsx)(Ht,{viewer:a,handleShowMarketplace:o,handleShowProperties:c,eids:l,setEids:d})})]})]})};function qt(e){var t=e.children,n=e.value,r=e.index,a=(0,dt.Z)(e,Vt);return(0,Z.jsx)("div",(0,x.Z)((0,x.Z)({role:"tabpanel",hidden:n!==r,id:"simple-tabpanel-".concat(r),"aria-labelledby":"simple-tab-".concat(r)},a),{},{children:n===r&&(0,Z.jsx)(ie.Box,{sx:{p:3},children:(0,Z.jsx)(ie.Typography,{children:t})})}))}var Jt=n(89788),Qt=n(56289),Kt=(0,w.makeStyles)((function(e){return{heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},table:{width:"100%"},cardExpanded:{position:"absolute",top:"0px",zIndex:1e3,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},card:{position:"absolute",top:"0px",zIndex:100,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},cardContent:{opacity:"0.95",height:"85%",overflowY:"auto",overflowX:"hidden","&::-webkit-scrollbar":{width:"0.4em"},"&::-webkit-scrollbar-track":{"-webkit-box-shadow":"inset 0 0 6px rgba(0,0,0,0.00)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.1)",outline:"0px solid slategrey"}},mapContainer:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column",height:400},map:{width:"100%",height:"100%"}}})),$t=function(e){e.bimData,e.setBimData;var t=e.viewer,n=(e.element,e.selectedElementID),a=(e.setSelectedElementID,e.setShowProperties),i=e.handleShowMarketplace,o=(e.addElementsNewProperties,(0,r.useState)(null)),c=(0,m.Z)(o,2),s=c[0],l=c[1],d=(0,r.useState)(null),u=(0,m.Z)(d,2),p=u[0],h=u[1],f=(0,r.useState)(!1),g=(0,m.Z)(f,2),v=g[0],b=g[1],I=(0,r.useState)(!1),j=(0,m.Z)(I,2),y=j[0],C=j[1],S=(0,r.useState)("100%"),k=(0,m.Z)(S,2),E=k[0],D=k[1],T=(0,r.useState)("100%"),B=(0,m.Z)(T,2),A=B[0],L=B[1],N=Kt({width:E,height:A});function M(e){for(var t=/\\X2\\((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?)\\X0\\/gi,n=e,r=t.exec(e);r;){var a=String.fromCharCode(parseInt(r[1],16));n=n.replace(r[0],a),r=t.exec(e)}return n}(0,r.useEffect)((function(){var e=function(){y||(D(window.innerWidth-175),L(window.innerHeight-175))};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((function(){function e(){return(e=(0,P.Z)((0,F.Z)().mark((function e(){var r,a,i,o,c,s,d,u,p,h,f,m,g,v,I,w,j,y,C,Z,S,k,E;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("selectedElementID",n),b(!0),!n){e.next=12;break}return e.next=5,t.IFC.getProperties(0,n,!0,!0);case 5:if(r=e.sent,console.log("elementProperties",r),a=t.IFC.loader.ifcManager.getIfcType(0,n),i=[],r.psets.length>0){o=(0,Te.Z)(r.psets);try{for(o.s();!(c=o.n()).done;)if((s=c.value).HasProperties&&s.HasProperties.length>0){d=[],u=(0,Te.Z)(s.HasProperties);try{for(u.s();!(p=u.n()).done;)h=p.value,f=M(h.Name.value),m=h.NominalValue?M(h.NominalValue.value):"",g=h.Description&&""!==h.Description?M(h.Description.value):null,v=h.Unit?h.Unit.Prefix?M(h.Unit.Prefix.value):h.Unit.Name?M(h.Unit.Name.value):h.Unit.value?M(h.Unit.value):"":"",d.push({label:f,description:g,value:m,unit:v})}catch(D){u.e(D)}finally{u.f()}i.push((0,x.Z)((0,x.Z)({},s),{},{HasProperties:[].concat(d)}))}else if(s.Quantities&&s.Quantities.length>0){I=[],w=(0,Te.Z)(s.Quantities);try{for(w.s();!(j=w.n()).done;)y=j.value,C=M(y.Name.value),Z=y.NominalValue?M(y.NominalValue.value):null,I.push({label:C,value:Z})}catch(D){w.e(D)}finally{w.f()}i.push((0,x.Z)((0,x.Z)({},s),{},{HasProperties:[].concat(I)}))}else i.push((0,x.Z)((0,x.Z)({},s),{},{HasProperties:[]}))}catch(D){o.e(D)}finally{o.f()}S=(0,Te.Z)(r.mats);try{for(S.s();!(k=S.n()).done;)k.value}catch(D){S.e(D)}finally{S.f()}}E=(0,x.Z)((0,x.Z)({},r),{},{name:r.Name?r.Name.value:"NO NAME",type:a||"NO TYPE",modelID:0,psets:i}),l(E);case 12:b(!1);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[n]);var R=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i("Open dthX"),a(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=Boolean(p),O=_?"simple-popover":void 0;return(0,Z.jsxs)(w.Card,{className:y?N.cardExpanded:N.card,children:[(0,Z.jsx)(w.CardHeader,{avatar:(0,Z.jsx)(w.Avatar,{"aria-label":"recipe",className:N.avatar,children:(0,Z.jsx)(W.Z,{})}),action:(0,Z.jsxs)("div",{children:[(0,Z.jsx)(w.IconButton,{"aria-label":"settings","aria-describedby":O,onClick:function(e){var t=window.innerWidth-175,n=window.innerHeight-175;y?y&&(C(!1),D("100%"),L("100%"),h(null)):(C(!0),D(t),L(n),h(null))},size:"small",children:y?(0,Z.jsx)(le.Z,{}):(0,Z.jsx)(se.Z,{})}),(0,Z.jsx)(w.IconButton,{"aria-label":"settings","aria-describedby":O,onClick:function(){a(!1)},size:"small",children:(0,Z.jsx)(ce.Z,{})}),(0,Z.jsx)(w.IconButton,{"aria-label":"settings","aria-describedby":O,onClick:function(e){h(e.currentTarget)},size:"small",children:(0,Z.jsx)(oe.Z,{})}),(0,Z.jsxs)(w.Popover,{id:O,open:_,anchorEl:p,onClose:function(){h(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[s&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(w.ListItem,{button:!0,onClick:function(e){var t;e.preventDefault();var n=[],r=["modelId","elementName","elementClass","globalId","expressId","psetName","propertyName","propertyValue"].join(",");n.push(r),null===(t=s.psets)||void 0===t||t.forEach((function(e){var t;return null===(t=e.HasProperties)||void 0===t?void 0:t.forEach((function(t){var r="".concat(s.modelID),a="".concat(s.name),i="".concat(s.type),o="".concat(s.GlobalId.value),c="".concat(s.expressID),l="".concat(e.Name.value),d=t.label,u=t.value;n.push([r,a,i,o,c,l,d,u].join(","))}))})),function(e){var t=e.data,n=e.fileName,r=e.fileType,a=new Blob([t],{type:r}),i=document.createElement("a");i.download=n,i.href=window.URL.createObjectURL(a);var o=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});i.dispatchEvent(o),i.remove()}({data:[].concat(n).join("\n"),fileName:"".concat(s?s.name:"Undefined",".csv"),fileType:"text/csv"})},children:[(0,Z.jsx)(w.ListItemIcon,{children:(0,Z.jsx)(ut.Z,{})}),(0,Z.jsx)(w.ListItemText,{primary:"T\xe9l\xe9charger CSV"})]}),(0,Z.jsxs)(w.ListItem,{button:!0,onClick:R,children:[(0,Z.jsx)(w.ListItemIcon,{children:(0,Z.jsx)(Jt.Z,{})}),(0,Z.jsx)(w.ListItemText,{primary:"Ajouter propri\xe9t\xe9"})]})]}),(0,Z.jsxs)(w.ListItem,{button:!0,onClick:function(){a(!1)},children:[(0,Z.jsx)(w.ListItemIcon,{children:(0,Z.jsx)(ce.Z,{})}),(0,Z.jsx)(w.ListItemText,{primary:"Fermer"})]})]})]}),title:"".concat(s?M(s.name):"Undefined"),subheader:"".concat(s?s.type:"Undefined"," - ").concat(n)}),(0,Z.jsx)(w.CardContent,{className:N.cardContent,children:v?(0,Z.jsx)(ie.Grid,{container:!0,children:(0,Z.jsx)(ie.Grid,{item:!0,md:12,style:{textAlign:"center"},children:(0,Z.jsx)(w.CircularProgress,{color:"inherit"})})}):(0,Z.jsx)(Z.Fragment,{children:s&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(w.Accordion,{children:[(0,Z.jsx)(w.AccordionSummary,{expandIcon:(0,Z.jsx)(Ze.Z,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:(0,Z.jsx)(w.Typography,{className:N.heading,children:"Attributes"})}),(0,Z.jsx)(w.AccordionDetails,{children:(0,Z.jsx)(w.TableContainer,{children:(0,Z.jsx)(w.Table,{className:N.table,"aria-label":"simple table",children:(0,Z.jsxs)(w.TableBody,{children:[(0,Z.jsxs)(w.TableRow,{children:[(0,Z.jsx)(w.TableCell,{children:"GlobalId"}),(0,Z.jsx)(w.TableCell,{children:"".concat(s.GlobalId.value)})]},0),(0,Z.jsxs)(w.TableRow,{children:[(0,Z.jsx)(w.TableCell,{children:"Name"}),(0,Z.jsx)(w.TableCell,{children:"".concat(s.name)})]},1),(0,Z.jsxs)(w.TableRow,{children:[(0,Z.jsx)(w.TableCell,{children:"Type"}),(0,Z.jsx)(w.TableCell,{children:"".concat(s.type)})]},2),s.PredefinedType&&(0,Z.jsxs)(w.TableRow,{children:[(0,Z.jsx)(w.TableCell,{children:"Predifined Type"}),(0,Z.jsx)(w.TableCell,{children:"".concat(s.PredefinedType.value)})]},2)]})})})})]}),s.psets.length>0&&s.psets.map((function(e,t){return(0,Z.jsxs)(w.Accordion,{children:[(0,Z.jsx)(w.AccordionSummary,{expandIcon:(0,Z.jsx)(Ze.Z,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:(0,Z.jsx)(w.Typography,{className:N.heading,children:"".concat(M(e.Name.value))})}),(0,Z.jsx)(w.AccordionDetails,{children:(0,Z.jsx)(w.TableContainer,{children:(0,Z.jsx)(w.Table,{className:N.table,"aria-label":"simple table",children:(0,Z.jsx)(w.TableBody,{children:e.HasProperties&&e.HasProperties.length>0&&e.HasProperties.map((function(e,t){return(0,Z.jsxs)(w.TableRow,{children:[(0,Z.jsx)(w.TableCell,{children:"".concat(e.label)}),(0,Z.jsx)(w.TableCell,{children:e.description&&""!==e.description&&(0,Z.jsx)(w.Tooltip,{title:"".concat(e.description),placement:"top-start",children:(0,Z.jsx)(w.IconButton,{children:(0,Z.jsx)(Ae.Z,{})})})}),RegExp("^http").test(e.value)?(0,Z.jsx)(w.TableCell,{children:(0,Z.jsx)("a",{href:"".concat(e.value),target:"_blank",rel:"noreferrer",children:"".concat(e.value)})}):(0,Z.jsx)(w.TableCell,{style:{maxWidth:"200px"},children:"".concat(e.value)}),(0,Z.jsx)(w.TableCell,{children:"".concat(e.unit)})]},t)}))})})})})]},t)}))]})})})]})},en=n(49134),tn=n.n(en),nn=n(54379),rn=n(47497),an=n(72996),on=(0,w.makeStyles)((function(e){return{heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},table:{width:"100%"},cardExpanded:{position:"absolute",top:"0px",zIndex:1e3,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},card:{position:"absolute",top:"0px",zIndex:100,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},cardContent:{opacity:"0.95",height:"85%",overflowY:"auto",overflowX:"hidden","&::-webkit-scrollbar":{width:"0.4em"},"&::-webkit-scrollbar-track":{"-webkit-box-shadow":"inset 0 0 6px rgba(0,0,0,0.00)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.1)",outline:"0px solid slategrey"}},avatar:{backgroundColor:"transparent",width:e.spacing(7),height:e.spacing(7),borderRadius:"0px"},fab:{backgroundColor:"white"},button:{color:"white",backgroundColor:"black",width:"100%",marginTop:"1em",marginBottom:"1em"},linearProgress:{width:"90%",margin:"1em",left:0,right:0}}})),cn={flex:1,display:"flex",height:"150px",flexDirection:"column",alignItems:"center",padding:"20px",borderWidth:2,borderRadius:2,width:"100%",borderColor:"#ddddd",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#bdbdbd",outline:"none",transition:"border .24s ease-in-out",cursor:"pointer"},sn=function(e){var t=e.bimData,n=(e.setBimData,e.showValidation,e.setShowValidation),a=(0,r.useMemo)((function(){return(0,x.Z)({},cn)}),[]),i=(0,r.useState)(null),o=(0,m.Z)(i,2),c=o[0],s=o[1],l=(0,r.useState)([]),d=(0,m.Z)(l,2),u=d[0],p=d[1],h=(0,r.useState)(null),f=(0,m.Z)(h,2),g=f[0],v=f[1],b=(0,r.useState)(-1),I=(0,m.Z)(b,2),j=I[0],y=I[1],C=(0,r.useState)(!1),S=(0,m.Z)(C,2),k=S[0],E=S[1],D=(0,r.useState)("100%"),T=(0,m.Z)(D,2),B=T[0],A=T[1],N=(0,r.useState)("100%"),M=(0,m.Z)(N,2),R=M[0],_=M[1];(0,r.useEffect)((function(){var e=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var n;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.viewer.context.items.ifcModels;case 2:(n=e.sent).length>0&&v(n[0]);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[g]);var O=on({width:B,height:R});(0,r.useEffect)((function(){var e=function(){k||(A(window.innerWidth-175),_(window.innerHeight-175))};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]);(0,r.useEffect)((function(){}),[j]);var G,W=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var n,r,a,i,o,c,s;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=function e(){me().get("".concat("https://bimanalyse.tridyme.com","/pp/").concat(s),{headers:{"Access-Control-Allow-Origin":"*"}}).then((function(t){var n=t.data.progress;100===n?(clearTimeout(G),y(n),me().get("".concat("https://bimanalyse.tridyme.com","/log/").concat(s,".json")).then((function(e){console.log("logs",e.data),p(e.data)}))):(console.log("progress",n),G=setTimeout(e,1e3),n>-1&&y(n))}))},y(0),e.next=5,t.viewer.IFC.loader.ifcManager.state.api.ExportFileAsIFC(0);case 5:return r=e.sent,a=new Blob([r],{type:"text/plain"}),i=new File([a],"ifcFile.png"),(o=new FormData).append("files",i),e.next=12,me().post("https://bimanalyse.tridyme.com",o,{headers:{"Access-Control-Allow-Origin":"*"}});case 12:return c=e.sent,s=c.data.projectId,console.log("projectId",s),e.next=17,n();case 17:e.next=21;break;case 19:e.prev=19,e.t0=e.catch(0);case 21:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(){return e.apply(this,arguments)}}(),z=(0,r.useCallback)(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r,a,i;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=new FormData).append("files",t[0]),!(t.length>0)){e.next=16;break}if(!(t[0].size/1024/1024>15)){e.next=7;break}alert("Version limit\xe9e \xe0 15 Mo"),e.next=16;break;case 7:return r=function e(){me().get("".concat("https://bimanalyse.tridyme.com","/pp/").concat(i),{headers:{"Access-Control-Allow-Origin":"*"}}).then((function(t){var n=t.data.progress;100===n?(clearTimeout(G),y(n),me().get("".concat("https://bimanalyse.tridyme.com","/log/").concat(i,".json"),{headers:{"Access-Control-Allow-Origin":"*"}}).then((function(e){console.log("logs",e.data),p(e.data)}))):(console.log("progress",n),G=setTimeout(e,1e3),n>-1&&y(n))}))},y(0),e.next=11,me().post("https://bimanalyse.tridyme.com",n,{headers:{"Access-Control-Allow-Origin":"*"}});case 11:return a=e.sent,i=a.data.projectId,console.log("projectId",i),e.next=16,r();case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),H=(0,L.useDropzone)({onDrop:z,accept:".ifc"}),V=H.getRootProps,U=H.getInputProps,Y=(H.isDragActive,Boolean(c)),X=Y?"simple-popover":void 0;return(0,Z.jsxs)(ie.Card,{className:k?O.cardExpanded:O.card,children:[(0,Z.jsx)(ie.CardHeader,{avatar:(0,Z.jsx)(ie.Avatar,{"aria-label":"recipe",className:O.avatar,children:(0,Z.jsx)(w.Fab,{size:"small",className:O.fab,children:(0,Z.jsx)(an.Z,{})})}),title:"Validation",subheader:"Syst\xe8me de validation d'un fichier IFC",action:(0,Z.jsxs)("div",{children:[(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":X,onClick:function(e){var t=window.innerWidth-175,n=window.innerHeight-175;k?k&&(E(!1),A("100%"),_("100%"),s(null)):(E(!0),A(t),_(n),s(null))},size:"small",children:k?(0,Z.jsx)(le.Z,{}):(0,Z.jsx)(se.Z,{})}),(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":X,onClick:function(){return n(!1)},size:"small",children:(0,Z.jsx)(rn.Z,{})}),(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":X,onClick:function(e){s(e.currentTarget)},size:"small",children:(0,Z.jsx)(nn.Z,{})}),(0,Z.jsxs)(ie.Popover,{id:X,open:Y,anchorEl:c,onClose:function(){s(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[u.length>0&&(0,Z.jsxs)(ie.ListItem,{button:!0,onClick:function(e){e.preventDefault();var t=[],n=["Severity","Message","Instance","Time"].join(",");t.push(n),null===u||void 0===u||u.forEach((function(e){var n=e.level,r=e.message,a=e.instance,i=e.time;t.push([n,r,a,i].join(","))})),function(e){var t=e.data,n=e.fileName,r=e.fileType,a=new Blob([t],{type:r}),i=document.createElement("a");i.download=n,i.href=window.URL.createObjectURL(a);var o=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});i.dispatchEvent(o),i.remove()}({data:[].concat(t).join("\n"),fileName:"logs.csv",fileType:"text/csv"})},children:[(0,Z.jsx)(ie.ListItemIcon,{children:(0,Z.jsx)(ut.Z,{})}),(0,Z.jsx)(ie.ListItemText,{primary:"T\xe9l\xe9charger CSV"})]}),(0,Z.jsxs)(ie.ListItem,{button:!0,onClick:function(){return n(!1)},children:[(0,Z.jsx)(ie.ListItemIcon,{children:(0,Z.jsx)(rn.Z,{})}),(0,Z.jsx)(ie.ListItemText,{primary:"Fermer"})]})]})]})}),(0,Z.jsxs)(ie.CardContent,{className:O.cardContent,children:[(0,Z.jsx)(ie.Grid,{item:!0,xs:12,align:"center",justify:"center",alignItems:"center",children:(0,Z.jsxs)("div",(0,x.Z)((0,x.Z)({},V({style:a})),{},{children:[(0,Z.jsx)("input",(0,x.Z)({},U())),(0,Z.jsx)("p",{children:"Importer votre fichier ici ou cliquez pour selectionner un fichier"})]}))}),j>=0&&j<100?(0,Z.jsx)(ie.Grid,{item:!0,xs:12,align:"center",justify:"center",alignItems:"center",children:(0,Z.jsx)(ln,{value:j})}):(0,Z.jsx)(Z.Fragment,{children:g&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(ie.Grid,{item:!0,xs:12,children:[(0,Z.jsx)("br",{}),(0,Z.jsx)(ie.Typography,{gutterBottom:!0,variant:"title2",component:"div",children:"Pour lancer l'audit de la maquette d\xe9ja charg\xe9e:"})]}),(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:(0,Z.jsx)(w.Button,{variant:"contained",className:O.button,onClick:W,children:"Audit"})})]})}),(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:u.length>0&&(0,Z.jsx)(ie.TableContainer,{component:ie.Paper,children:(0,Z.jsxs)(ie.Table,{className:O.table,"aria-label":"simple table",children:[(0,Z.jsx)(ie.TableHead,{children:(0,Z.jsxs)(ie.TableRow,{children:[(0,Z.jsx)(ie.TableCell,{children:"Severity"}),(0,Z.jsx)(ie.TableCell,{align:"left",children:"Message"}),(0,Z.jsx)(ie.TableCell,{align:"left",children:"Instance"}),(0,Z.jsx)(ie.TableCell,{align:"left",children:"time"})]})}),u.map((function(e,t){return(0,Z.jsxs)(ie.TableRow,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,Z.jsx)(ie.TableCell,{style:{color:"".concat("Error"===e.level?"red":"orange")},children:e.level}),(0,Z.jsx)(ie.TableCell,{children:e.message}),(0,Z.jsx)(ie.TableCell,{children:e.instance}),(0,Z.jsx)(ie.TableCell,{children:e.time})]},t)}))]})})})]})]})};function ln(e){var t=on();return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(ie.Box,{display:"flex",className:t.root,alignItems:"center",children:0===e.value?(0,Z.jsx)("div",{className:t.linearProgress,children:"V\xe9rification en cours..."}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(ie.Box,{width:"100%",mr:1,children:(0,Z.jsx)(ie.LinearProgress,(0,x.Z)({className:t.linearProgress,variant:"determinate"},e))}),(0,Z.jsx)(ie.Box,{minWidth:35,children:(0,Z.jsx)(ie.Typography,{variant:"body2",color:"textSecondary",children:"".concat(Math.round(e.value),"%")})})]})})})}var dn=n(76826),un=(0,w.makeStyles)((function(e){return{heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},table:{width:"100%"},cardExpanded:{position:"absolute",top:"0px",zIndex:1e3,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},card:{position:"absolute",top:"0px",zIndex:100,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},cardContent:{opacity:"0.95",height:"85%",overflowY:"auto",overflowX:"hidden","&::-webkit-scrollbar":{width:"0.4em"},"&::-webkit-scrollbar-track":{"-webkit-box-shadow":"inset 0 0 6px rgba(0,0,0,0.00)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.1)",outline:"0px solid slategrey"}},avatar:{backgroundColor:"transparent",width:e.spacing(7),height:e.spacing(7),borderRadius:"0px"},fab:{backgroundColor:"white"}}})),pn=function(e){var t=e.viewer,n=e.showCuts,a=e.setShowCuts,i=(0,r.useState)(null),o=(0,m.Z)(i,2),c=o[0],s=o[1],l=(0,r.useState)([]),d=(0,m.Z)(l,2),u=(d[0],d[1]),p=(0,r.useState)(!1),h=(0,m.Z)(p,2),f=(h[0],h[1],(0,r.useState)(!1)),x=(0,m.Z)(f,2),g=x[0],v=x[1],b=(0,r.useState)(!1),I=(0,m.Z)(b,2),j=I[0],y=I[1],C=(0,r.useState)("100%"),S=(0,m.Z)(C,2),k=S[0],E=S[1],D=(0,r.useState)("100%"),T=(0,m.Z)(D,2),B=T[0],A=T[1],L=un({width:k,height:B});(0,r.useEffect)((function(){var e=function(){j||(E(window.innerWidth-175),A(window.innerHeight-175))};return t.clipper.active=!0,window.addEventListener("resize",e),window.addEventListener("dblclick",N,!1),function(){t.clipper.active=!1,window.removeEventListener("resize",e),window.removeEventListener("dblclick",N,!1)}}),[]);var N=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),console.log("viewer",t),e.next=4,t.clipper.createPlane();case 4:console.log("viewer.clipper.planes",t.clipper.planes),console.log("viewer.plans.planLists",t.plans.planLists),u(t.clipper.planes),v(!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(r,a){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=7;break}return v(!0),e.next=4,t.clipper.deletePlane(r);case 4:v(!1),console.log("viewer.clipper.planes",t.clipper.planes),window.removeEventListener("dblclick",N,!1);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),R=Boolean(c),_=R?"simple-popover":void 0;return(0,Z.jsxs)(ie.Card,{className:j?L.cardExpanded:L.card,children:[(0,Z.jsx)(ie.CardHeader,{avatar:(0,Z.jsx)(ie.Avatar,{"aria-label":"recipe",className:L.avatar,children:(0,Z.jsx)(w.Fab,{size:"small",className:L.fab,children:(0,Z.jsx)(dn.Z,{})})}),title:"Coupes",subheader:"Liste des coupes",action:(0,Z.jsxs)("div",{children:[(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":_,onClick:function(e){var t=window.innerWidth-175,n=window.innerHeight-175;j?j&&(y(!1),E("100%"),A("100%"),s(null)):(y(!0),E(t),A(n),s(null))},size:"small",children:j?(0,Z.jsx)(le.Z,{}):(0,Z.jsx)(se.Z,{})}),(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":_,onClick:function(){t.clipper.active=!1,window.removeEventListener("dblclick",N,!1),a(!1)},size:"small",children:(0,Z.jsx)(rn.Z,{})}),(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":_,onClick:function(e){s(e.currentTarget)},size:"small",children:(0,Z.jsx)(nn.Z,{})}),(0,Z.jsx)(ie.Popover,{id:_,open:R,anchorEl:c,onClose:function(){s(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,Z.jsxs)(ie.ListItem,{button:!0,onClick:function(){t.clipper.active=!1,window.removeEventListener("dblclick",N,!1),a(!1)},children:[(0,Z.jsx)(ie.ListItemIcon,{children:(0,Z.jsx)(rn.Z,{})}),(0,Z.jsx)(ie.ListItemText,{primary:"Fermer"})]})})]})}),(0,Z.jsx)(ie.CardContent,{children:(0,Z.jsxs)(ie.Grid,{container:!0,spacing:2,children:[(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:(0,Z.jsx)(w.Typography,{gutterBottom:!0,variant:"title2",component:"div",children:"Double-cliquer sur une surface pour g\xe9n\xe9rer une coupe"})}),(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:g?(0,Z.jsx)(ie.CircularProgress,{color:"inherit"}):(0,Z.jsx)(ie.List,{sx:{width:"100%"},children:t.clipper.planes.length>0&&t.clipper.planes.map((function(e,t){return(0,Z.jsx)(ie.ListItem,{secondaryAction:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(ie.IconButton,{edge:"end","aria-label":"comments",onClick:function(){return M(e,t)},children:(0,Z.jsx)(pt.Z,{})})}),disablePadding:!0,children:(0,Z.jsx)(ie.ListItemButton,{role:void 0,dense:!0,children:(0,Z.jsx)(ie.ListItemText,{id:"checkbox-list-label-".concat(t),primary:"".concat(e.arrowBoundingBox.uuid)})})},t)}))})})]})})]})},hn=n(31734),fn=n.n(hn),mn=n(33867),xn=(n(89873),n(26146)),gn=n(7745),vn=(0,w.makeStyles)((function(){return{activePlan:{color:"#E6464D"},button:{color:"white",backgroundColor:"black",width:"100%"}}})),bn=function(e){var t=e.viewer,n=e.setPlans,a=(0,r.useState)([]),i=(0,m.Z)(a,2),o=i[0],c=i[1],s=(0,r.useState)(!1),l=(0,m.Z)(s,2),d=l[0],u=l[1],p=(0,r.useState)(),h=(0,m.Z)(p,2),f=h[0],x=h[1],g=vn(),v=new xn.Y;new Qt.MeshBasicMaterial,fn().ACI.BLUE,B.IFCWINDOW,B.IFCPLATE,B.IFCMEMBER,fn().ACI.RED,B.IFCWALL,B.IFCWALLSTANDARDCASE,fn().ACI.RED,B.IFCSLAB,fn().ACI.YELLOW,B.IFCDOOR,fn().ACI.RED,B.IFCFURNISHINGELEMENT,fn().ACI.RED,B.IFCSTAIR,B.IFCSTAIRFLIGHT,fn().ACI.CYAN,B.IFCFURNISHINGELEMENT,fn().ACI.CYAN,B.IFCSLAB,B.IFCWINDOW,B.IFCDOOR,B.IFCSTAIRFLIGHT,B.IFCSTAIR,B.IFCRAILING,B.IFCMEMBER;(0,r.useEffect)((function(){var e=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var r;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u(!0),e.next=4,t.plans.computeAllPlanViews(0);case 4:r=Object.values(t.plans.planLists[0]),c(r),n(r),u(!1),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var b=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(n,r){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("drawing",n),t.plans.goTo(0,"".concat(n.expressID),!1);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),I=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(),e.next=3,t.plans.exitPlanView();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,Z.jsx)(ie.Grid,{container:!0,children:(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:d?(0,Z.jsx)(ie.Grid,{item:!0,xs:12,style:{textAlign:"center"},children:(0,Z.jsx)(ie.CircularProgress,{color:"inherit"})}):(0,Z.jsxs)(ie.List,{className:g.list,disablePadding:!0,children:[(0,Z.jsx)(ie.ListItem,{disablePadding:!0,secondaryAction:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(ie.IconButton,{edge:"end","aria-label":"comments",className:g.button,onClick:function(){return I()},children:(0,Z.jsx)(gn.Z,{})})}),children:(0,Z.jsx)(ie.ListItemButton,{role:void 0,dense:!0,children:(0,Z.jsx)(ie.ListItemText,{primary:(0,Z.jsx)(w.Typography,{gutterBottom:!0,variant:"h6",component:"div",children:"Liste des vues des \xe9tages:"})})})}),(0,Z.jsx)("hr",{}),o.length>0&&o.map((function(e,t){return(0,Z.jsx)(ie.ListItem,{disablePadding:!0,className:t===f?g.activePlan:"",secondaryAction:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(ie.IconButton,{style:{color:t===f?"#E6464D":""},edge:"end","aria-label":"comments",onClick:function(){return b(e)},children:(0,Z.jsx)(mn.Z,{})})}),children:(0,Z.jsx)(ie.ListItemButton,{role:void 0,dense:!0,children:(0,Z.jsx)(ie.ListItemText,{id:"checkbox-list-label-".concat(t),primary:"".concat(e.name)})})},t)}))]})})})},In=(n(22046),n(11353),(0,w.makeStyles)((function(e){return{heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},table:{width:"100%"},cardInfo:{zIndex:100,width:"100%",height:"100%"},cardContent:{height:"90%",overflowY:"auto",overflowX:"hidden","&::-webkit-scrollbar":{width:"0.4em"},"&::-webkit-scrollbar-track":{"-webkit-box-shadow":"inset 0 0 6px rgba(0,0,0,0.00)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.1)",outline:"0px solid slategrey"}},avatar:{backgroundColor:"transparent",width:e.spacing(7),height:e.spacing(7),borderRadius:"0px"},fab:{backgroundColor:"white"}}})),["children","value","index"]),wn=(0,w.makeStyles)((function(e){return{heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},table:{width:"100%"},cardExpanded:{position:"absolute",top:"0px",zIndex:1e3,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},card:{position:"absolute",top:"0px",zIndex:100,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},cardContent:{opacity:"0.95",height:"85%",overflowY:"auto",overflowX:"hidden","&::-webkit-scrollbar":{width:"0.4em"},"&::-webkit-scrollbar-track":{"-webkit-box-shadow":"inset 0 0 6px rgba(0,0,0,0.00)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.1)",outline:"0px solid slategrey"}},avatar:{backgroundColor:"transparent",width:e.spacing(7),height:e.spacing(7),borderRadius:"0px"},fab:{backgroundColor:"white"}}})),jn=function(e){var t=e.viewer,n=(e.showDrawings,e.setShowDrawings),a=(0,r.useState)(null),i=(0,m.Z)(a,2),o=i[0],c=i[1],s=(0,r.useState)(0),l=(0,m.Z)(s,2),d=l[0],u=l[1],p=(0,r.useState)(!1),h=(0,m.Z)(p,2),f=h[0],g=h[1],v=(0,r.useState)("100%"),b=(0,m.Z)(v,2),I=b[0],j=b[1],y=(0,r.useState)("100%"),C=(0,m.Z)(y,2),S=C[0],k=C[1],E=(0,r.useState)([]),D=(0,m.Z)(E,2),T=D[0],B=D[1],A=wn({width:I,height:S});(0,r.useEffect)((function(){var e=function(){f||(j(window.innerWidth-175),k(window.innerHeight-175))};return window.addEventListener("resize",e),(0,P.Z)((0,F.Z)().mark((function n(){var r,a,i;return(0,F.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:N(),window.removeEventListener("resize",e),r=(0,Te.Z)(T),n.prev=3,r.s();case 5:if((a=r.n()).done){n.next=11;break}return i=a.value,n.next=9,t.plans.clipper.deletePlane(i.plane);case 9:n.next=5;break;case 11:n.next=16;break;case 13:n.prev=13,n.t0=n.catch(3),r.e(n.t0);case 16:return n.prev=16,r.f(),n.finish(16);case 19:case"end":return n.stop()}}),n,null,[[3,13,16,19]])})))}),[T]);var L,N=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.plans.exitPlanView();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=Boolean(o),R=M?"simple-popover":void 0;return(0,Z.jsxs)(ie.Card,{className:f?A.cardExpanded:A.card,children:[(0,Z.jsx)(ie.CardHeader,{avatar:(0,Z.jsx)(ie.Avatar,{"aria-label":"recipe",className:A.avatar,children:(0,Z.jsx)(w.Fab,{size:"small",className:A.fab,children:(0,Z.jsx)(Y.Z,{})})}),title:"Plans",subheader:"Liste des plans",action:(0,Z.jsxs)("div",{children:[(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":R,onClick:function(e){var t=window.innerWidth-175,n=window.innerHeight-175;f?f&&(g(!1),j("100%"),k("100%"),c(null)):(g(!0),j(t),k(n),c(null))},size:"small",children:f?(0,Z.jsx)(le.Z,{}):(0,Z.jsx)(se.Z,{})}),(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":R,onClick:function(){t.clipper.active=!1,n(!1)},size:"small",children:(0,Z.jsx)(rn.Z,{})}),(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":R,onClick:function(e){c(e.currentTarget)},size:"small",children:(0,Z.jsx)(nn.Z,{})}),(0,Z.jsx)(ie.Popover,{id:R,open:M,anchorEl:o,onClose:function(){c(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,Z.jsxs)(ie.ListItem,{button:!0,onClick:function(){t.clipper.active=!1,n(!1)},children:[(0,Z.jsx)(ie.ListItemIcon,{children:(0,Z.jsx)(rn.Z,{})}),(0,Z.jsx)(ie.ListItemText,{primary:"Fermer"})]})})]})}),(0,Z.jsxs)(ie.CardContent,{className:A.cardContent,children:[(0,Z.jsx)(ie.Box,{sx:{borderBottom:1,borderColor:"divider"},children:(0,Z.jsx)(ie.Tabs,{value:d,onChange:function(e,t){u(t)},"aria-label":"basic tabs example",children:(0,Z.jsx)(ie.Tab,(0,x.Z)({label:"Plans"},(L=0,{id:"simple-tab-".concat(L),"aria-controls":"simple-tabpanel-".concat(L)})))})}),(0,Z.jsx)(yn,{value:d,index:0,children:(0,Z.jsx)(bn,{viewer:t,setPlans:B})})]})]})},yn=function(e){var t=e.children,n=e.value,r=e.index,a=(0,dt.Z)(e,In);return(0,Z.jsx)("div",(0,x.Z)((0,x.Z)({role:"tabpanel",hidden:n!==r,id:"simple-tabpanel-".concat(r),"aria-labelledby":"simple-tab-".concat(r)},a),{},{children:n===r&&(0,Z.jsx)(ie.Box,{sx:{p:3},children:(0,Z.jsx)(ie.Typography,{children:t})})}))},Cn=n(6606),Zn=(0,w.makeStyles)((function(e){return{heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},table:{width:"100%"},cardExpanded:{position:"absolute",top:"0px",zIndex:1e3,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},card:{position:"absolute",top:"0px",zIndex:100,left:"0px",right:"0px",opacity:"0.95",width:function(e){return e.width},height:function(e){return e.height},maxWidth:window.innerWidth-175,maxHeight:window.innerHeight-175},cardContent:{opacity:"0.95",height:"90%",overflowY:"auto",overflowX:"hidden","&::-webkit-scrollbar":{width:"0.4em"},"&::-webkit-scrollbar-track":{"-webkit-box-shadow":"inset 0 0 6px rgba(0,0,0,0.00)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.1)",outline:"0px solid slategrey"}},avatar:{backgroundColor:"transparent",width:e.spacing(7),height:e.spacing(7),borderRadius:"0px"},fab:{backgroundColor:"white"}}})),Sn=function(e){var t=e.viewer,n=(e.showMeasures,e.setShowMeasures),a=(0,r.useState)(null),i=(0,m.Z)(a,2),o=i[0],c=i[1],s=(0,r.useState)([]),l=(0,m.Z)(s,2),d=(l[0],l[1]),u=(0,r.useState)(!1),p=(0,m.Z)(u,2),h=p[0],f=p[1],x=(0,r.useState)(!1),g=(0,m.Z)(x,2),v=(g[0],g[1],(0,r.useState)(!1)),b=(0,m.Z)(v,2),I=b[0],j=b[1],y=(0,r.useState)(!1),C=(0,m.Z)(y,2),S=C[0],k=C[1],E=(0,r.useState)("100%"),D=(0,m.Z)(E,2),B=D[0],A=D[1],L=(0,r.useState)("100%"),N=(0,m.Z)(L,2),M=N[0],R=N[1],_=Zn({width:B,height:M});(0,r.useEffect)((function(){var e=function(){S||(A(window.innerWidth-175),R(window.innerHeight-175))};console.log("dimensions",t.dimensions.dimensions),d(t.dimensions.dimensions);return t.dimensions.active=true,t.dimensions.previewActive=true,t.dimensions.lineMaterial=new Qt.LineDashedMaterial({color:0,linewidth:2,depthTest:!1,dashSize:.1,gapSize:.1}),window.addEventListener("resize",e),window.addEventListener("mousemove",O,!1),window.addEventListener("dblclick",W,!1),window.addEventListener("keydown",G,!1),function(){t.dimensions.active=false,t.dimensions.previewActive=false,window.removeEventListener("resize",e),window.removeEventListener("mousemove",O,!1),window.removeEventListener("dblclick",W,!1),window.removeEventListener("keydown",G,!1)}}),[]);var O=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.IFC.selector.prePickIfcItem();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(e){"Escape"===e.code&&t.dimensions.cancelDrawing(),"Delete"!==e.code&&"Backspace"!==e.code&&"keyD"!==e.code||(n(!1),t.dimensions.deleteAll())},W=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var n;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j(!0),console.log("HELLoo"),f(n=!h),!n){e.next=8;break}return e.next=7,t.dimensions.create();case 7:d(t.dimensions.dimensions);case 8:j(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(n,r){var a,i,o;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),console.log("measure",n),console.log("dimensions",a),e.next=5,t.dimensions.dimensions;case 5:return a=e.sent,console.log("measure",n),console.log("dimensions",a),e.next=10,a.find((function(e){return e.textLabel.uuid===n.textLabel.uuid}));case 10:return i=e.sent,e.next=13,a.findIndex((function(e){return e.textLabel.uuid===n.textLabel.uuid}));case 13:if(!((o=e.sent)>-1)){e.next=21;break}return e.next=17,a.splice(o,1);case 17:return e.sent,e.next=20,i.removeFromScene();case 20:d((0,T.Z)(a));case 21:j(!1);case 22:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),H=Boolean(o),V=H?"simple-popover":void 0;return(0,Z.jsxs)(ie.Card,{className:S?_.cardExpanded:_.card,children:[(0,Z.jsx)(ie.CardHeader,{avatar:(0,Z.jsx)(ie.Avatar,{"aria-label":"recipe",className:_.avatar,children:(0,Z.jsx)(w.Fab,{size:"small",className:_.fab,children:(0,Z.jsx)(Cn.Z,{})})}),title:"Outils de mesures",subheader:"Liste des mesures",action:(0,Z.jsxs)("div",{children:[(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":V,onClick:function(e){var t=window.innerWidth-175,n=window.innerHeight-175;S?S&&(k(!1),A("100%"),R("100%"),c(null)):(k(!0),A(t),R(n),c(null))},size:"small",children:S?(0,Z.jsx)(le.Z,{}):(0,Z.jsx)(se.Z,{})}),(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":V,onClick:function(){t.dimensions.active=false,t.dimensions.previewActive=false,n(!1)},size:"small",children:(0,Z.jsx)(rn.Z,{})}),(0,Z.jsx)(ie.IconButton,{"aria-label":"settings","aria-describedby":V,onClick:function(e){c(e.currentTarget)},size:"small",children:(0,Z.jsx)(nn.Z,{})}),(0,Z.jsx)(ie.Popover,{id:V,open:H,anchorEl:o,onClose:function(){c(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,Z.jsxs)(ie.ListItem,{button:!0,onClick:function(){t.dimensions.active=false,t.dimensions.previewActive=false,n(!1)},children:[(0,Z.jsx)(ie.ListItemIcon,{children:(0,Z.jsx)(rn.Z,{})}),(0,Z.jsx)(ie.ListItemText,{primary:"Fermer"})]})})]})}),(0,Z.jsx)(ie.CardContent,{children:(0,Z.jsxs)(ie.Grid,{container:!0,spacing:2,children:[(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:(0,Z.jsx)(ie.Typography,{gutterBottom:!0,variant:"title2",component:"div",children:"Double-cliquer pour cr\xe9er une mesure"})}),(0,Z.jsx)(ie.Grid,{item:!0,xs:12,children:I?(0,Z.jsx)(ie.CircularProgress,{color:"inherit"}):(0,Z.jsx)(ie.List,{sx:{width:"100%"},children:t.dimensions.dimensions.length>0&&t.dimensions.dimensions.map((function(e,t){return(0,Z.jsx)(ie.ListItem,{secondaryAction:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(ie.IconButton,{edge:"end","aria-label":"comments",onClick:function(){return z(e,t)},children:(0,Z.jsx)(pt.Z,{})})}),disablePadding:!0,children:(0,Z.jsx)(ie.ListItemButton,{role:void 0,dense:!0,children:(0,Z.jsx)(ie.ListItemText,{id:"checkbox-list-label-".concat(t),primary:"Mesure-".concat(e.textLabel.uuid)})})},t)}))})})]})})]})},kn=n(57543),En=n(11855),Dn=n(94466),Tn=n(44607),Fn=n(1598),Pn=n(1337),Bn=n(58917),An=n(53711),Ln=n(43767),Nn=n.p+"8bde820ab92b00b56f5b.png",Mn=function(e){var t=e.viewer,n=e.showContextMenu,a=(e.meshMaterials,e.setShowContextMenu),i=e.setShowProperties,o=(e.setShowSpatialStructure,e.handleShowMarketplace),c=e.eids,s=e.setEids,l=(e.subsets,e.setSubsets,(0,r.useState)({x:0,y:0})),d=(0,m.Z)(l,2),u=d[0],p=d[1];(0,r.useEffect)((function(){return document.addEventListener("contextmenu",h),function(){document.removeEventListener("contextmenu",h)}}));var h=function(e){console.log("eids",c),c.length>0&&(e.preventDefault(),p({x:e.pageX,y:e.pageY}),a(!0))},f=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.length>0&&(i(!0),a(!1));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var n,r,i;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(c.length>0)){e.next=12;break}return e.next=3,t.IFC.getProperties(0,c[0],!1,!1);case 3:return n=e.sent,e.next=6,t.getAllItemsOfType(0,n.type,!1,!1);case 6:return r=e.sent,i=[].concat((0,T.Z)(c),(0,T.Z)(r)),s(i),e.next=11,t.IFC.pickIfcItemsByID(0,i);case 11:a(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o("Open dthX"),a(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.IFC.loader.ifcManager.removeFromSubset(0,c,"full-model-subset");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var n,r,a,i;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.context.items.ifcModels,r=n[0],a=Array.from(new Set(r.geometry.attributes.expressID.array)),i=a.reduce((function(e,t){return-1===c.indexOf(t)&&e.push(t),e}),[]),t.IFC.loader.ifcManager.removeFromSubset(0,i,"full-model-subset");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var n,r,a;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.context.items.ifcModels,r=n[0],a=Array.from(new Set(r.geometry.attributes.expressID.array)),t.IFC.loader.ifcManager.createSubset({modelID:r.modelID,ids:a,applyBVH:!0,scene:r.parent,removePrevious:!0,customID:"full-model-subset"});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return n&&(0,Z.jsx)(Dn.Z,{sx:{width:250,maxWidth:"100%",top:u.y,left:u.x,position:"absolute",opacity:"0.95"},children:(0,Z.jsxs)(Tn.Z,{children:[(0,Z.jsxs)(Fn.Z,{onClick:x,children:[(0,Z.jsx)(Bn.Z,{children:(0,Z.jsx)(An.Z,{fontSize:"small"})}),(0,Z.jsx)(Pn.Z,{children:"S\xe9lection par Classe"})]}),(0,Z.jsxs)(Fn.Z,{onClick:b,children:[(0,Z.jsx)(Bn.Z,{children:(0,Z.jsx)(mn.Z,{fontSize:"small"})}),(0,Z.jsx)(Pn.Z,{children:"Isoler"})]}),(0,Z.jsxs)(Fn.Z,{onClick:v,children:[(0,Z.jsx)(Bn.Z,{children:(0,Z.jsx)(Ln.Z,{fontSize:"small"})}),(0,Z.jsx)(Pn.Z,{children:"Cacher"})]}),(0,Z.jsxs)(Fn.Z,{onClick:I,children:[(0,Z.jsx)(Bn.Z,{children:(0,Z.jsx)(gn.Z,{fontSize:"small"})}),(0,Z.jsx)(Pn.Z,{children:"R\xe9tablir Mod\xe8le"})]}),(0,Z.jsx)(En.Z,{}),(0,Z.jsxs)(Fn.Z,{onClick:f,children:[(0,Z.jsx)(Bn.Z,{children:(0,Z.jsx)(W.Z,{fontSize:"small"})}),(0,Z.jsx)(Pn.Z,{children:"Propri\xe9t\xe9s"})]}),(0,Z.jsxs)(Fn.Z,{onClick:g,children:[(0,Z.jsx)(Bn.Z,{children:(0,Z.jsx)(kn.Z,{"aria-label":"recipe",src:Nn,style:{width:"1em",height:"auto"}})}),(0,Z.jsx)(Pn.Z,{children:"Ajout Propri\xe9t\xe9s"})]})]})})},Rn=n(24526),_n=(0,w.makeStyles)((function(e){return{draggableCard:{position:"absolute",marginTop:"1em",display:"flex",left:"5em",alignItems:"center",justifyContent:"center",backgroundColor:"red",zIndex:100}}})),On={display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},Gn=function(e){var t=e.children,n=e.disableDragging,a=e.width,i=e.height,o=(_n(),(0,r.useState)({width:a||400,height:i||400,x:80,y:20})),c=(0,m.Z)(o,2),s=c[0],l=c[1];return(0,Z.jsx)(Rn.Rnd,{style:On,size:{width:s.width,height:s.height},position:{x:s.x,y:s.y},onDragStop:function(e,t){l({x:t.x,y:t.y})},onResizeStop:function(e,t,n,r,a){l((0,x.Z)({width:n.style.width,height:n.style.height},a))},disableDragging:n,children:t})},Wn=(n(20125),n(61193)),zn=(n(14490),n(42900),n.p+"fe4e22a1ab8f6fd342e4.png"),Hn=n.p+"399ff36562e4fdeab54b.png",Vn=n.p+"661c96e6a8fda6139846.png",Un=(n(41189),n(12502)),Yn=n.n(Un);new Set(["IfcCartesianPoint","IfcArbitraryClosedProfileDef","IfcDirection","IfcAxis2Placement3D","IfcAxis2Placement2D","IfcLocalPlacement","IfcShapeRepresentation","IfcRectangleProfileDef","IfcPolyline","IfcPlane","IfcExtrudedAreaSolid","IfcSurfaceStyleRendering","IfcSurfaceStyle","IfcPresentationStyleAssignment","IfcStyledRepresentation","IfcCartesianTransformationOperator3D","IfcColourRgb","IfcCartesianTransformationOperator3DNonUniform","IfcStyledItem","IfcCurveBoundedPlane","IfcConnectionSurfaceGeometry","IfcProductDefinitionShape","IfcGeometricRepresentationContext","IfcGeometricRepresentationSubcontext","IfcPolyLoop","IfcFaceOuterBound","IfcFace","IfcCartesianTransformationOperator3DnonUniform","IfcFaceBound","IfcClosedShell","IfcFacetedBrep","IfcRepresentationMap","IfcMappedItem","IfcRelFillsElement","IfcArbitraryProfileDefWithVoids","IfcCompositeCurve","IfcCompositeCurveSegment","IfcCircle","IfcEllipse","IfcCircleHollowProfileDef","IfcRectangleHollowProfileDef","IfcLine","IfcIShapeProfileDef","IfcGeometricRepresentationContext","IfcGeometricRepresentationSubContext","IfcCurveStyle","IfcDraughtingPreDefinedCurveFont","IfcGeometricSet","IfcCircleProfileDef","IfcPolygonalBoundedHalfSpace","IfcFaceBasedSurfaceModel","IfcConnectedFaceSet","IfcTrimmedCurve","IfcOpenShell","IfcShellBasedSurfaceModel","IfcHalfSpaceSolid","IfcBooleanClippingResult","IfcGeometricCurveSet","IfcCurveStyleFont","IfcCurveStyleFontPattern"]);n.p,n.p;var Xn=n(54314),qn=n(55248),Jn=function(){function e(){(0,Xn.Z)(this,e),this.hello="Hello TriBim"}return(0,qn.Z)(e,[{key:"sayHello",value:function(){console.log("Hello toi")}}]),e}(),Qn=(0,w.makeStyles)((function(e){return{root:{width:"100vw",height:"100vh",spacing:0,justify:"space-around",margin:0,padding:0,flexGrow:1,"& .MuiTextField-root":{margin:e.spacing(1),backgroundColor:"white"},"& .MuiContainer-maxWidthLg":{maxWidth:"100%"}},infoLeftPannel:{left:"1em",position:"absolute",zIndex:100},infoRightPannel:{right:"1em",position:"absolute",zIndex:100},fab:{margin:"0.5em",backgroundColor:"white"}}})),Kn="https://backend.api.management.tridyme.com",$n=function(){var e,t,n,a,i,o,c,s,l,d,u,p,h,g,v=Qn(),b=(0,r.useRef)(null),I=(0,r.useState)(null),j=(0,m.Z)(I,2),y=j[0],C=j[1],S=(0,r.useState)([]),k=(0,m.Z)(S,2),E=k[0],D=k[1],L=(0,r.useState)(-1),X=(0,m.Z)(L,2),J=X[0],Q=X[1],K=(0,r.useState)(null),$=(0,m.Z)(K,2),ee=($[0],$[1],(0,r.useState)([])),te=(0,m.Z)(ee,2),ne=te[0],ae=te[1],ie=(0,r.useState)(null),oe=(0,m.Z)(ie,2),ce=oe[0],se=(oe[1],(0,r.useState)(!1)),le=(0,m.Z)(se,2),de=le[0],ue=le[1],pe=(0,r.useState)(!1),he=(0,m.Z)(pe,2),fe=he[0],xe=(he[1],(0,r.useState)(!0)),ge=(0,m.Z)(xe,2),ve=(ge[0],ge[1],(0,r.useState)(!1)),be=(0,m.Z)(ve,2),Ie=be[0],we=be[1],je=(0,r.useState)(!1),ye=(0,m.Z)(je,2),Ce=ye[0],Ze=ye[1],Se=(0,r.useState)(!1),ke=(0,m.Z)(Se,2),Ee=ke[0],De=ke[1],Fe=(0,r.useState)(!1),Pe=(0,m.Z)(Fe,2),Be=Pe[0],Ae=Pe[1],Le=(0,r.useState)(!1),Ne=(0,m.Z)(Le,2),Me=Ne[0],Re=Ne[1],_e=(0,r.useState)(!1),Oe=(0,m.Z)(_e,2),Ge=Oe[0],We=Oe[1],ze=(0,r.useState)(!1),He=(0,m.Z)(ze,2),Ve=He[0],Ue=He[1],Ye=(0,r.useState)(!1),Xe=(0,m.Z)(Ye,2),qe=Xe[0],Je=Xe[1],Qe=(0,r.useState)(!1),Ke=(0,m.Z)(Qe,2),$e=Ke[0],et=Ke[1],nt=(0,r.useState)(null),rt=(0,m.Z)(nt,2),at=rt[0],it=rt[1],ot=(0,r.useState)(!1),ct=(0,m.Z)(ot,2),st=ct[0],dt=ct[1],ut=(0,r.useState)(0),pt=(0,m.Z)(ut,2),ht=(pt[0],pt[1]),ft=(0,r.useState)(),mt=(0,m.Z)(ft,2),xt=(mt[0],mt[1]),gt=(0,r.useState)(null),vt=(0,m.Z)(gt,2),bt=(vt[0],vt[1],(0,r.useState)([])),It=(0,m.Z)(bt,2),wt=It[0],jt=It[1],yt=(0,r.useState)([]),Ct=(0,m.Z)(yt,2),Zt=Ct[0],St=Ct[1],kt=(0,r.useState)({AxeoBim:!1}),Et=(0,m.Z)(kt,2),Dt=Et[0],Tt=Et[1],Ft=(0,r.useState)({loading:!1,loadingMessage:"Chargement...",alertStatus:!0,alertMessage:"Connect\xe9",bcfDialogOpen:!1,loaded:!1,loadingIfc:!1,openLeftView:!1,leftView:"spatialStructure",viewer:"",api:{},models:{value:0,list:[],data:[]},spatialStructures:{value:{},list:[]},subsets:{value:{},list:[]},search:{value:"",list:[],data:[]},jsonData:{value:{},list:[]}}),Pt=(0,m.Z)(Ft,2),Bt=Pt[0],At=Pt[1],Lt=function(e){var t=e.eids,n=e.setEids,a=e.state,i=e.setState,o=(0,r.useState)([]),c=(0,m.Z)(o,2),s=c[0],l=c[1],d=(0,r.useState)(!1),u=(0,m.Z)(d,2),p=(u[0],u[1],function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var t;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new(Yn())("tribimDB")).version(1).stores({models:"title, content, file"}),t.open().catch((function(e){console.log(e.stack||e)})),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),h={invisibleMaterial:new Qt.MeshLambertMaterial({transparent:!0,opacity:0,color:7842559,depthTest:!1,side:Qt.DoubleSide})},f=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.models.toArray();case 2:return n=e.sent,console.log("allModels",n),l(n),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(e,t,n,r){(!(arguments.length>4&&void 0!==arguments[4])||arguments[4])&&e.IFC.pickIfcItemsByID(n,r),t(n)},v=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(r){var a,i,o,c,s,l,d,u;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.viewer,i=r.setModelID,o=r.setElement,e.next=3,a.IFC.pickIfcItem(!0,1);case 3:if(null!=(c=e.sent)&&void 0!=c){e.next=9;break}return e.next=7,a.IFC.unpickIfcItems();case 7:return n([]),e.abrupt("return");case 9:return i(c.modelID),n([c.id]),console.log("eid",t),g(a,i,c.modelID,c.id,!1),e.next=16,a.IFC.getProperties(c.modelID,c.id,!0,!0);case 16:return s=e.sent,console.log(s),e.next=20,a.IFC.loader.ifcManager.getIfcType(c.modelID,c.id);case 20:if(l=e.sent,console.log(l),!(s.psets.length>0)){e.next=28;break}return e.next=25,Promise.all(s.psets.map(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.HasProperties&&t.HasProperties.length>0)){e.next=5;break}return e.next=3,Promise.all(t.HasProperties.map(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.Name.value,r=t.NominalValue&&t.NominalValue.value?t.NominalValue.value:"",e.abrupt("return",{label:n,value:r});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return n=e.sent,e.abrupt("return",(0,x.Z)((0,x.Z)({},t),{},{HasProperties:(0,T.Z)(n)}));case 5:if(!(t.Quantities&&t.Quantities.length>0)){e.next=10;break}return e.next=8,Promise.all(t.Quantities.map(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.Name.value,r=t.NominalValue?t.NominalValue.value:null,e.abrupt("return",{label:n,value:r});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:return r=e.sent,e.abrupt("return",(0,x.Z)((0,x.Z)({},t),{},{HasProperties:(0,T.Z)(r)}));case 10:return e.abrupt("return",(0,x.Z)((0,x.Z)({},t),{},{HasProperties:[]}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 25:d=e.sent,(u=(0,x.Z)((0,x.Z)({},s),{},{type:l||"NO TYPE",modelID:c.modelID,psets:d}))&&o(u);case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function b(e){return{type:1,value:e}}function I(e){return{type:5,value:e}}function w(e){return{type:2,label:"IFCTEXT",valueType:1,value:e}}var j=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t,n,r){var a,i,o,c,s,l;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],i=0,o=(0,Te.Z)(n),e.prev=3,o.s();case 5:if((c=o.n()).done){e.next=15;break}return s=c.value,r({loading:!0,message:"Recherche: ".concat(Math.round(i/n.length*100)," %")}),i++,e.next=11,t.IFC.getProperties(0,s.expressID,!1,!1);case 11:l=e.sent,a.push((0,x.Z)((0,x.Z)((0,x.Z)({},s),l),{},{type:s.type}));case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),o.e(e.t0);case 20:return e.prev=20,o.f(),e.finish(20);case 23:return e.abrupt("return",a);case 24:case"end":return e.stop()}}),e,null,[[3,17,20,23]])})));return function(t,n,r){return e.apply(this,arguments)}}(),y=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r,a,i,o,c,s,l,d,u;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.expressID,r=t.type,a=t.name,i=t.description,o=t.value,c=t.unit,s=t.property,l=function(e,t){if(null==t)return w("no value");switch(e){case"IfcLabel":case"IfcText":default:return w("".concat(t));case"IfcBoolean":return{type:2,label:"IFCBOOLEAN",valueType:1,value:"".concat(t)}}},d=new B.IfcPropertySingleValue(n,r,b(a?"".concat(a):"no name"),b("".concat(i||a)),l(s.ifc_type,o),c?b("".concat(c)):{type:6},{type:6}),u={ID:d.expressID,type:d.type,arguments:d.ToTape()},e.abrupt("return",u);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r,a,i,o,c,s,l,d;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.expressID,r=t.type,a=t.globalId,i=t.ifcOwnerHistoryExpressID,o=t.name,c=t.description,s=t.ifcPropertySingleValueExpressIDs,l=new B.IfcPropertySet(n,r,a||{type:6},i||{type:6},o||{type:6},c||{type:6},s),d={ID:l.expressID,type:l.type,arguments:l.ToTape()},e.abrupt("return",d);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r,a,i,o,c,s,l,d,u;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.expressID,r=t.type,a=t.globalId,i=t.ifcOwnerHistoryExpressID,o=t.name,c=t.description,s=t.elementsList,l=t.ifcPropertySetExpressID,d=new B.IfcRelDefinesByProperties(n,r,a||{type:6},i||{type:6},o||{type:6},c||{type:6},s,l),u={ID:d.expressID,type:d.type,arguments:d.ToTape()},e.abrupt("return",u);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function S(e){return null===e||void 0===e?void 0:e.replace(/'/g,"''")}var k=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r,o,c,s,l,d,u,p,h,f,m,g,v,w,j,k,E,D,P,A,L,N,M,R,_,O,G,W,z,H,V,U,Y,X,q,J,Q,K,$,ee,te,ne,re;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.bimData,t.setBimData,r=t.viewer,o=t.modelId,c=t.expressIDs,s=t.properties,i((0,x.Z)((0,x.Z)({},a),{},{loading:!0,loadingMessage:"D\xe9but de l'enrichissement...",alertStatus:!0,alertMessage:"Connect\xe9"})),console.log("bimBata",n.models),l=n.models.list[o],d=n.models.data[o],e.next=7,r.IFC.loader.ifcManager;case 7:return u=e.sent,e.next=10,u.ifcAPI.GetAllLines(o);case 10:return p=e.sent,h=0,e.next=14,Object.keys(p._data).forEach((function(e){h=Math.max(h,p._data[e])}));case 14:return e.next=16,c.map((function(e){return I(e)}));case 16:return f=e.sent,e.next=19,u.getAllItemsOfType(o,B.IFCOWNERHISTORY,!1);case 19:return m=e.sent,g=m&&m.length>0?m[0]:1,v="Pset_opendthx",e.next=25,u.getAllItemsOfType(0,B.IFCRELDEFINESBYPROPERTIES,!1);case 25:w=e.sent,console.log("relPsetIDs",w),console.log("relPsetIDs.length",w.length),j=new Date,k=(0,Te.Z)(w),e.prev=30,k.s();case 32:if((E=k.n()).done){e.next=52;break}if(D=E.value,P=d[parseInt(D)],console.log("relPset",P),A=P.RelatingPropertyDefinition,d[parseInt(A)].Name!==v){e.next=50;break}L=(0,T.Z)(P.RelatedObjects),N=!1,M=(0,Te.Z)(c);try{for(_=function(){var e=R.value,t=L.findIndex((function(t){return t===e}));t>-1&&(N=!0,L.splice(t,1))},M.s();!(R=M.n()).done;)_()}catch(F){M.e(F)}finally{M.f()}if(!N){e.next=50;break}return e.next=46,u.getItemProperties(0,D);case 46:return(O=e.sent).RelatedObjects=L.map((function(e){return I(e)})),e.next=50,u.ifcAPI.WriteLine(0,O);case 50:e.next=32;break;case 52:e.next=57;break;case 54:e.prev=54,e.t0=e.catch(30),k.e(e.t0);case 57:return e.prev=57,k.f(),e.finish(57);case 60:if(G=new Date,W=G.getTime()-j.getTime(),console.log("time spent step 1: ".concat(W/1e3,"s")),!(s.length>0)){e.next=107;break}console.log("maxExpressId",h),z=h+1,console.log("ifcPropertySingleValueEid",z),H=[],V=(0,Te.Z)(s),e.prev=69,V.s();case 71:if((U=V.n()).done){e.next=82;break}return Y=U.value,X=z++,e.next=76,y({expressID:X,type:B.IFCPROPERTYSINGLEVALUE,name:S(Y.ifc_property_name),description:S(Y.property_definition),value:Y.text_value,unit:Y.unit,property:Y});case 76:return q=e.sent,e.next=79,r.IFC.loader.ifcManager.state.api.WriteRawLineData(o,q);case 79:H.push(I(X));case 80:e.next=71;break;case 82:e.next=87;break;case 84:e.prev=84,e.t1=e.catch(69),V.e(e.t1);case 87:return e.prev=87,V.f(),e.finish(87);case 90:if(console.log("newPsetOpendthXEids",H),!(H.length>0)){e.next=107;break}return J=z+1,e.next=96,C({expressID:J,type:B.IFCPROPERTYSET,globalId:b(Math.random().toString(16).substr(2,8)),ifcOwnerHistoryExpressID:I(g),name:b("Pset_opendthx"),ifcPropertySingleValueExpressIDs:H});case 96:return Q=e.sent,e.next=99,r.IFC.loader.ifcManager.state.api.WriteRawLineData(o,Q);case 99:return K=J+1,console.log("ifcPropertySetEid",J),console.log("ifcRelDefinesByPropertiesEid",K),e.next=104,Z({expressID:K,type:B.IFCRELDEFINESBYPROPERTIES,globalId:b(Math.random().toString(16).substr(2,8)),ifcOwnerHistoryExpressID:I(g),name:{type:6},description:{type:6},elementsList:f,ifcPropertySetExpressID:I(J)});case 104:return $=e.sent,e.next=107,r.IFC.loader.ifcManager.state.api.WriteRawLineData(o,$);case 107:return e.next=109,r.IFC.properties.serializeAllProperties(l,void 0,(function(e,t){var n=e/t,r=Math.trunc(100*n);i((0,x.Z)((0,x.Z)({},a),{},{loading:!0,loadingMessage:"Chargement des donn\xe9es: ".concat(r," %")}))}));case 109:return ee=e.sent,te=new File(ee,"properties"),e.t2=JSON,e.next=114,te.text();case 114:e.t3=e.sent,ne=e.t2.parse.call(e.t2,e.t3),re=new Date,W=re.getTime()-G.getTime(),console.log("time spent step 2: ".concat(W/1e3,"s")),i((0,x.Z)((0,x.Z)({},a),{},{models:(0,x.Z)((0,x.Z)({},a.models),{},{data:[ne]}),loading:!1,alertStatus:!0,alertMessage:"Enrichissement r\xe9ussi"}));case 120:case"end":return e.stop()}}),e,null,[[30,54,57,60],[69,84,87,90]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r,o,c,s,l,d,u,p,h,f,m,g,v,w,j,k,E,D,P;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.viewer,r=t.modelId,o=t.expressIDs,c=t.properties,i((0,x.Z)((0,x.Z)({},a),{},{loading:!0,loadingMessage:"D\xe9but de l'enrichissement...",alertStatus:!0,alertMessage:"Connect\xe9"})),e.next=4,n.IFC.loader.ifcManager;case 4:return s=e.sent,e.next=7,s.ifcAPI.GetAllLines(r);case 7:return l=e.sent,d=0,e.next=11,Object.keys(l._data).forEach((function(e){d=Math.max(d,l._data[e])}));case 11:return e.next=13,o.map((function(e){return I(e)}));case 13:return u=e.sent,e.next=16,n.IFC.loader.ifcManager.getAllItemsOfType(r,B.IFCOWNERHISTORY,!1);case 16:if(p=e.sent,h=p&&p.length>0?p[0]:1,f=[],m=[],g=d+1,v=0,!(c.length>0)){e.next=40;break}w=(0,Te.Z)(c),e.prev=25,k=(0,F.Z)().mark((function e(){var t,s,l,d,p,w,k,E,D,P,A,L,N,M,R,_,O,G,W,z,H;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=j.value,i((0,x.Z)((0,x.Z)({},a),{},{loading:!0,loadingMessage:"Enrichissement: ".concat(Math.round(v/c.length*100)," %")})),v++,s=[],l=[],d=(0,Te.Z)(o),e.prev=6,d.s();case 8:if((p=d.n()).done){e.next=21;break}return E=p.value,e.next=12,n.IFC.getProperties(0,E,!1,!1);case 12:return D=e.sent,e.next=15,null===(w=D.psets)||void 0===w?void 0:w.map((function(e){var n;null===(n=e.HasProperties)||void 0===n||n.forEach((function(e){var n,r;(null===(n=e.Name)||void 0===n?void 0:n.value)!==t.ifc_property_name&&(null===(r=e.Name)||void 0===r?void 0:r.value)!==t.property_name||l.push(e)}))}));case 15:return e.next=17,null===(k=D.psets)||void 0===k?void 0:k.find((function(e){var n;return(null===(n=e.Name)||void 0===n?void 0:n.value)===t.ifc_class}));case 17:(P=e.sent)&&s.push(P);case 19:e.next=8;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(6),d.e(e.t0);case 26:return e.prev=26,d.f(),e.finish(26);case 29:if(!(l.length>0)){e.next=38;break}return A=l[0],e.next=33,y({expressID:A.expressID,type:B.IFCPROPERTYSINGLEVALUE,name:S(A.Name.value),description:S(t.property_definition),value:t.text_value,unit:t.unit,property:t});case 33:return L=e.sent,e.next=36,n.IFC.loader.ifcManager.state.api.WriteRawLineData(r,L);case 36:e.next=73;break;case 38:return N=g+=1,e.next=42,y({expressID:N,type:B.IFCPROPERTYSINGLEVALUE,name:S(t.ifc_property_name),description:S(t.property_definition),value:t.text_value,unit:t.unit,property:t});case 42:return M=e.sent,e.next=45,n.IFC.loader.ifcManager.state.api.WriteRawLineData(r,M);case 45:if(!(s.length>0)){e.next=55;break}return _=s[0],O=null===(R=_.HasProperties)||void 0===R?void 0:R.map((function(e){return I(e.expressID)})),e.next=50,C({expressID:_.expressID,type:_.type,globalId:_.GlobalId,ifcOwnerHistoryExpressID:I(h),name:_.Name,description:_.Description,ifcPropertySingleValueExpressIDs:[].concat((0,T.Z)(O),[I(N)])});case 50:return G=e.sent,e.next=53,n.IFC.loader.ifcManager.state.api.WriteRawLineData(r,G);case 53:e.next=73;break;case 55:if("Pset_opendthx"===t.ifc_class||""===t.ifc_class){e.next=72;break}return W=g+=1,e.next=60,C({expressID:W,type:B.IFCPROPERTYSET,globalId:b(Math.random().toString(16).substr(2,8)),ifcOwnerHistoryExpressID:I(h),name:b(t.ifc_class),ifcPropertySingleValueExpressIDs:[I(N)]});case 60:return z=e.sent,e.next=63,n.IFC.loader.ifcManager.state.api.WriteRawLineData(r,z);case 63:return m.push(I(W)),g+=1,e.next=67,Z({expressID:g,type:B.IFCRELDEFINESBYPROPERTIES,globalId:b(Math.random().toString(16).substr(2,8)),ifcOwnerHistoryExpressID:I(h),name:{type:6},description:{type:6},elementsList:u,ifcPropertySetExpressID:I(W)});case 67:return H=e.sent,e.next=70,n.IFC.loader.ifcManager.state.api.WriteRawLineData(r,H);case 70:e.next=73;break;case 72:f.push(I(N));case 73:case"end":return e.stop()}}),e,null,[[6,23,26,29]])})),w.s();case 28:if((j=w.n()).done){e.next=32;break}return e.delegateYield(k(),"t0",30);case 30:e.next=28;break;case 32:e.next=37;break;case 34:e.prev=34,e.t1=e.catch(25),w.e(e.t1);case 37:return e.prev=37,w.f(),e.finish(37);case 40:if(!(f.length>0)){e.next=54;break}return E=g+=1,e.next=45,C({expressID:E,type:B.IFCPROPERTYSET,globalId:b(Math.random().toString(16).substr(2,8)),ifcOwnerHistoryExpressID:I(h),name:b("Pset_opendthx"),ifcPropertySingleValueExpressIDs:f});case 45:return D=e.sent,e.next=48,n.IFC.loader.ifcManager.state.api.WriteRawLineData(r,D);case 48:return g+=1,e.next=51,Z({expressID:g,type:B.IFCRELDEFINESBYPROPERTIES,globalId:b(Math.random().toString(16).substr(2,8)),ifcOwnerHistoryExpressID:I(h),name:{type:6},description:{type:6},elementsList:u,ifcPropertySetExpressID:I(E)});case 51:return P=e.sent,e.next=54,n.IFC.loader.ifcManager.state.api.WriteRawLineData(r,P);case 54:i((0,x.Z)((0,x.Z)({},a),{},{loading:!1,alertStatus:!0,alertMessage:"Enrichissement r\xe9ussi"}));case 55:case"end":return e.stop()}}),e,null,[[25,34,37,40]])})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r,a,i,o,c,s;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.bimData,r=t.setBimData,a=t.viewer,i=t.modelID,o=t.expressIDs,c=t.properties,s=i||0,console.log("ADD PROPERTY"),o&&o.length>0&&c.length>0&&k({bimData:n,setBimData:r,viewer:a,modelId:s,expressIDs:o,properties:c});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var t,n,r,i;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.viewer.IFC.loader.ifcManager.state.api.ExportFileAsIFC(0);case 3:t=e.sent,n=new Blob([t],{type:"text/plain"}),r=new File([n],"ifcFile.png"),(i=new FormData).append("files",r),me().post("https://bimanalyse.tridyme.com",i).then((function(e){return console.log("value.data",e.data),e.data})).then(function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,e.next=3,me().get("".concat("https://bimanalyse.tridyme.com","/log/").concat(n,".json"));case 3:r=e.sent,console.log("logs",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("ERRORRR",e)})),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(0);case 13:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t,n){var r,a,i,o;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.context.items.ifcModels,a=r[n],i=Array.from(new Set(a.geometry.attributes.expressID.array)),o=N(t,a,i),M(t,a,o);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function N(e,t,n){return e.IFC.loader.ifcManager.createSubset({modelID:t.modelID,ids:n,applyBVH:!0,scene:t.parent,removePrevious:!0,customID:"full-model-subset"})}function M(e,t,n){var r=e.context.items;r.pickableIfcModels=r.pickableIfcModels.filter((function(e){return e!==t})),r.ifcModels=r.ifcModels.filter((function(e){return e!==t})),t.removeFromParent(),r.ifcModels.push(n),r.pickableIfcModels.push(n)}return{models:s,meshMaterials:h,initIndexDB:p,getModels:f,addTransformControls:function(e){var t=e.IFC.context.scene.scene,n=e.IFC.context.renderer.renderer,r=e.IFC.context.ifcCamera.activeCamera,a=e.IFC.context.ifcCamera.controls,i=new Qt.Mesh(new Qt.BoxGeometry(1,1,1),new Qt.MeshLambertMaterial({color:"red",side:Qt.DoubleSide}));t.add(i);var o=new Wn.Ys(r,n.domElement);o.addEventListener("change",(function(){n.render(t,r)})),o.addEventListener("dragging-changed",(function(e){a.enabled=!e.value})),t.add(o),o.attach(i)},getElementProperties:v,addElementsNewProperties:D,editIfcModel:E,handleCheckNetworkStatus:function(){function e(){console.log("navigator.onLine",navigator.onLine),i((0,x.Z)((0,x.Z)({},a),{},{alertStatus:navigator.onLine,alertMessage:navigator.onLine?"Connect\xe9":"Non connect\xe9"}))}return window.addEventListener("online",e),window.addEventListener("offline",e),function(){window.removeEventListener("online",e),window.removeEventListener("offline",e)}},handleGetJsonData:j,handleModelValidation:A,handleInitSubset:L}}({eids:wt,setEids:jt,state:Bt,setState:At}),Nt=Lt.initIndexDB,Mt=Lt.meshMaterials,Rt=Lt.getModels,_t=(Lt.addTransformControls,Lt.getElementProperties,Lt.addElementsNewProperties),Ot=(Lt.addGeometryToIfc,Lt.editIfcModel,Lt.handleCheckNetworkStatus),Gt=Lt.handleGetJsonData,Wt=(Lt.handleModelValidation,Lt.handleInitSubset);(0,r.useEffect)((function(){function e(){return(e=(0,P.Z)((0,F.Z)().mark((function e(){var t,n,r,a,i;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("viewer-container"),n=new A.IfcViewerAPI({container:t,backgroundColor:new Qt.Color(16777215)}),At((0,x.Z)((0,x.Z)({},Bt),{},{loading:!0,viewer:n})),r=new B.IfcAPI,xt(r),n.IFC.setWasmPath("../../files/"),n.IFC.applyWebIfcConfig({COORDINATE_TO_ORIGIN:!0,USE_FAST_BOOLS:!1}),n.IFC.loader.ifcManager.useWebWorkers(!0,"../../files/IFCWorker.js"),e.next=10,Nt();case 10:return a=e.sent,e.next=13,Rt(a);case 13:return i=e.sent,console.log("allModels",i),At((0,x.Z)((0,x.Z)({},Bt),{},{loading:!1})),C(n),e.next=19,Ht({viewer:n});case 19:return e.next=21,Vt({viewer:n});case 21:Ot();case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var zt=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r,a,i,o,c,s,l,d,u,p;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.files,r=t.viewer,!n||!r){e.next=42;break}return At((0,x.Z)((0,x.Z)({},Bt),{},{loading:!0})),console.log("MODEL",n[0]),r.IFC.loader.ifcManager.setOnProgress((function(e){var t=Math.floor(100*e.loaded/e.total);console.log("percentage",t),ht(t),At((0,x.Z)((0,x.Z)({},Bt),{},{loading:!0,loadingMessage:"Chargement de la g\xe9om\xe9trie: ".concat(t," %")}))})),r.IFC.loader.ifcManager.parser.setupOptionalCategories((a={},(0,f.Z)(a,B.IFCSPACE,!0),(0,f.Z)(a,B.IFCOPENINGELEMENT,!1),(0,f.Z)(a,B.IFCSTRUCTURALANALYSISMODEL,!0),(0,f.Z)(a,B.IFCSTRUCTURALSURFACEMEMBER,!0),(0,f.Z)(a,B.IFCSTRUCTURALCURVEMEMBER,!0),a)),e.prev=6,e.next=9,r.IFC.loadIfc(n[0],!0,Yt);case 9:i=e.sent,e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(6),console.log("error:",e.t0),e.abrupt("return");case 16:return Q(i.modelID),o=[].concat((0,T.Z)(E),[i]),D(o),e.next=21,Wt(r,0);case 21:return e.next=23,r.IFC.properties.serializeAllProperties(i,void 0,(function(e,t){var n=e/t,r=Math.trunc(100*n);console.log(r+"%"),ht(r),At((0,x.Z)((0,x.Z)({},Bt),{},{loading:!0,loadingMessage:"Chargement des donn\xe9es: ".concat(r," %")}))}));case 23:return c=e.sent,s=new File(c,"properties"),e.t1=JSON,e.next=28,s.text();case 28:return e.t2=e.sent,l=e.t1.parse.call(e.t1,e.t2),console.log("data",l),At((0,x.Z)((0,x.Z)({},Bt),{},{loading:!0,loadingMessage:"Chargement: g\xe9n\xe9ration de l'arborescence du projet"})),e.next=34,r.IFC.getSpatialStructure(i.modelID,!0);case 34:d=e.sent,At((0,x.Z)((0,x.Z)({},Bt),{},{loading:!0,loadingMessage:"Chargement: fin de la g\xe9n\xe9ration de l'arborescence du projet"})),console.log("newSpatialStructure",d),u=[].concat((0,T.Z)(ne),[d]),ae(u),console.log("updateSpatialStructure",u),p=new Jn,At((0,x.Z)((0,x.Z)({},Bt),{},{loading:!1,api:p,viewer:r,models:(0,x.Z)((0,x.Z)({},Bt.models),{},{list:[].concat((0,T.Z)(Bt.models.list),[i]),data:[].concat((0,T.Z)(Bt.models.data),[l])}),spatialStructures:{value:(0,x.Z)({},d),list:(0,T.Z)(u)}}));case 42:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t){return e.apply(this,arguments)}}();var Ht=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r,a,i,o,c,s,l,d,u,p,h,f,m;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.viewer,r=new URLSearchParams(window.location.search),a=r.get("code"),i=r.get("state"),!a||!i){e.next=27;break}return At({state:i,loading:!0}),o=sessionStorage.getItem("axeobim_access_token"),c=sessionStorage.getItem("axeobim_refresh_token"),e.next=10,Ut({code:a,state:i,accessToken:o,refreshToken:c});case 10:s=e.sent,l=s.idDocument,d=s.idEnvironnement,u=s.access_token,p=s.refresh_token,h=s.file,sessionStorage.setItem("axeobim_access_token",u),sessionStorage.setItem("axeobim_refresh_token",p),sessionStorage.setItem("axeobim_id_document",l),sessionStorage.setItem("axeobim_id_environnement",d),f=new Blob([h],{type:"text/plain"}),console.log("ifcBlob",f),m=new File([f],"ifcFile"),console.log("model",m),zt({files:[m],viewer:n}),At((0,x.Z)((0,x.Z)({},i),{},{loading:!1})),Tt((0,x.Z)((0,x.Z)({},Dt),{},{AxeoBim:!0}));case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Vt=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r,a,i,o,c,s,l,d;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.viewer,r=new URLSearchParams(window.location.search),a=r.get("content_id"),i=r.get("space_id"),o=r.get("user_id"),console.log("handleInitTracim Content ID:",a),console.log("handleInitTracim Space ID:",i),console.log("handleInitTracim User ID:",o),!(a&&i&&o)){e.next=28;break}return At({state:Bt,loading:!0}),e.prev=10,e.next=13,me()({method:"post",url:"".concat(Kn,"/tracim/getModel"),headers:{"Content-Type":"application/json"},data:{space_id:i,content_id:a,user_id:o}});case 13:c=e.sent,console.log("Response :",c.data),s=c.data,l=new Blob([s],{type:"text/plain"}),console.log("ifcBlob",l),d=new File([l],"ifcFile"),console.log("model",d),zt({files:[d],viewer:n}),At((0,x.Z)((0,x.Z)({},Bt),{},{loading:!1})),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(10),console.error("err",e.t0),At((0,x.Z)((0,x.Z)({},Bt),{},{loading:!1,alertStatus:!1,alertMessage:"model loading failed"}));case 28:case"end":return e.stop()}}),e,null,[[10,24]])})));return function(t){return e.apply(this,arguments)}}(),Ut=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r,a,i,o,c,s,l,d,u,p,h;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.code,r=t.state,a=t.accessToken,i=t.refreshToken,e.prev=1,console.log("code",n),e.next=5,me()({method:"post",url:"".concat(Kn,"/axeobim/getModel"),headers:{"Content-Type":"application/json"},data:{code:n,state:r,accessToken:a,refreshToken:i}});case 5:if(o=e.sent,c=sessionStorage.getItem("axeobim_lock_token"),!o.data||c){e.next=14;break}return s=o.data,l=s.idDocument,d=s.idEnvironnement,u=s.access_token,p=s.refresh_token,console.log("LOCK"),e.next=12,me()({method:"post",url:"".concat(Kn,"/axeobim/lockModel"),headers:{"Content-Type":"application/json"},data:{idDocument:l,idEnvironnement:d,accessToken:u,refreshToken:p}});case 12:h=e.sent,sessionStorage.setItem("axeobim_lock_token",h.data.lock_token);case 14:return At((0,x.Z)((0,x.Z)({},r),{},{alertStatus:!0,alertMessage:"Connect\xe9"})),e.abrupt("return",o.data);case 18:e.prev=18,e.t0=e.catch(1),console.log("err",e.t0),At((0,x.Z)((0,x.Z)({},r),{},{loading:!1,alertStatus:!1,alertMessage:e.t0.response.data.error}));case 22:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(t){return e.apply(this,arguments)}}(),Yt=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:alert(t.toString());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qt=function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];a&&e.IFC.pickIfcItemsByID(n,r),t(n)},Jt=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(t){var n,r;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Be&&Ae(!1),e.next=3,y.IFC.pickIfcItem(!1,1);case 3:if(null!=(n=e.sent)&&void 0!=n){e.next=9;break}return e.next=7,y.IFC.unpickIfcItems();case 7:return wt.length>0&&jt([]),e.abrupt("return");case 9:if(Q(n.modelID),!t.shiftKey){e.next=18;break}return r=[].concat((0,T.Z)(wt),[n.id]),jt(r),qt(y,Q,n.modelID,r,!1),e.next=16,y.IFC.pickIfcItemsByID(0,r);case 16:e.next=20;break;case 18:jt([n.id]),qt(y,Q,n.modelID,[n.id],!1);case 20:it(n.id);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Kt=function(e){dt(e),we(!Ie)},en=function(){Ze(!Ce)},nn=function(e){console.log("selectedElemID",e),e&&it(e),De(!0)},rn=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(){var t,n,r,a;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return At((0,x.Z)((0,x.Z)({},Bt),{},{loading:!0,loadingMessage:"G\xe9n\xe9ration de l'IFC..."})),J||0,e.next=4,y.IFC.loader.ifcManager.state.api.ExportFileAsIFC(0);case 4:t=e.sent,console.log("ifcData",t),n=(new TextDecoder).decode(t),r=n.replace("FILE_NAME('no name', '', (''), (''), 'web-ifc-export');","FILE_NAME('0001','2011-09-07T12:40:02',(''),(''),'Autodesk Revit MEP 2011 - 1.0','20100326_1700 (Solibri IFC Optimizer)','');"),console.log("newIfcDataString",r),(a=document.createElement("a")).setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(r)),a.setAttribute("download","export.ifc"),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),At((0,x.Z)((0,x.Z)({},Bt),{},{loading:!1}));case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(w.Grid,{container:!0,children:[(0,Z.jsxs)(w.Grid,{item:!0,xs:2,className:v.infoLeftPannel,children:[qe&&(0,Z.jsx)(Gn,{children:(0,Z.jsx)(Sn,{viewer:y,showMeasures:qe,setShowMeasures:Je})}),fe&&(0,Z.jsx)(Gn,{children:(0,Z.jsx)(q(),{})}),de&&(0,Z.jsx)(Gn,{children:(0,Z.jsx)(re,{open:de,onClose:function(){ue(!1)},onOpenViewpoint:function(e){y.currentViewpoint=e}})}),Ce&&(0,Z.jsx)(Gn,{width:700,height:600,children:(0,Z.jsx)(Xt,{state:Bt,setState:At,viewer:y,handleShowSpatialStructure:en,handleShowMarketplace:Kt,handleShowProperties:nn,handleGetJsonData:Gt,eids:wt,setEids:jt})}),at&&Ee&&(0,Z.jsx)(Gn,{children:(0,Z.jsx)($t,{bimData:Bt,setBimData:At,viewer:y,element:ce,setShowProperties:De,selectedElementID:at,setSelectedElementID:it,handleShowMarketplace:Kt,addElementsNewProperties:_t})}),Ie&&(0,Z.jsx)(Gn,{disableDragging:!0,width:600,height:600,children:(0,Z.jsx)(lt,{bimData:Bt,setBimData:At,viewer:y,modelID:J,handleShowMarketplace:Kt,specificApplication:st,setSpecificApplication:dt,onDrop:zt,eids:wt,setEids:jt,addElementsNewProperties:_t,apiConnectors:Dt,setApiConnectors:Tt})}),Me&&(0,Z.jsx)(Gn,{children:(0,Z.jsx)(tn(),{viewer:y,showCamera:Me,setShowCamera:Re})}),Ge&&(0,Z.jsx)(Gn,{children:(0,Z.jsx)(pn,{viewer:y,showCuts:Ge,setShowCuts:We})}),Ve&&(0,Z.jsx)(Gn,{children:(0,Z.jsx)(jn,{viewer:y,showDrawings:Ve,setShowDrawings:Ue})}),$e&&(0,Z.jsx)(Gn,{children:(0,Z.jsx)(sn,{bimData:Bt,setBimData:At,showValidation:$e,setShowValidation:et})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(tt,{title:"Importer IFC",placement:"right",className:v.fab,onClick:function(){b.current.open()},children:(0,Z.jsx)(R.Z,{})})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(tt,{title:"Arborescence du projet",placement:"right",className:v.fab,onClick:en,disabled:0===(null===y||void 0===y||null===(e=y.context)||void 0===e||null===(t=e.items)||void 0===t?void 0:t.ifcModels.length),children:(0,Z.jsx)(G.Z,{})})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(tt,{title:(0,Z.jsxs)("p",{children:["Propri\xe9t\xe9s:",(0,Z.jsx)("br",{}),"cliquez sur un objet de votre maquette, puis sur cet ic\xf4ne pour acc\xe9der \xe0 ses propri\xe9t\xe9s"]}),placement:"right",className:v.fab,onClick:function(){return nn()},disabled:0===(null===y||void 0===y||null===(n=y.context)||void 0===n||null===(a=n.items)||void 0===a?void 0:a.ifcModels.length),children:(0,Z.jsx)(W.Z,{})})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(tt,{title:"Place de march\xe9",placement:"right",disabled:!Bt.alertStatus,className:v.fab,onClick:function(){return Kt("home")},children:(0,Z.jsx)(H.Z,{})})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(tt,{title:"Coupes",placement:"right",className:v.fab,onClick:function(){We(!Ge)},disabled:0===(null===y||void 0===y||null===(i=y.context)||void 0===i||null===(o=i.items)||void 0===o?void 0:o.ifcModels.length),children:(0,Z.jsx)(_.Z,{})})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(tt,{title:"Plans",placement:"right",className:v.fab,onClick:function(){Ue(!Ve)},disabled:0===(null===y||void 0===y||null===(c=y.context)||void 0===c||null===(s=c.items)||void 0===s?void 0:s.ifcModels.length),children:(0,Z.jsx)(Y.Z,{})})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(tt,{title:"Outils de mesure",placement:"right",className:v.fab,onClick:function(){Je(!qe)},disabled:0===(null===y||void 0===y||null===(l=y.context)||void 0===l||null===(d=l.items)||void 0===d?void 0:d.ifcModels.length),children:(0,Z.jsx)(z.Z,{})})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(tt,{title:"Capture d'\xe9cran",placement:"right",className:v.fab,onClick:function(){var e=document.createElement("a");e.href=y.context.renderer.newScreenshot(!1,void 0,new Qt.Vector2(4e3,4e3));var t=new Date;e.download="capture-".concat(t,".jpeg"),document.body.appendChild(e),e.click(),e.remove()},disabled:0===(null===y||void 0===y||null===(u=y.context)||void 0===u||null===(p=u.items)||void 0===p?void 0:p.ifcModels.length),children:(0,Z.jsx)(O.Z,{})})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(tt,{title:"Reinitialise la page",placement:"right",className:v.fab,onClick:function(){window.location.reload()},disabled:0===(null===y||void 0===y||null===(h=y.context)||void 0===h||null===(g=h.items)||void 0===g?void 0:g.ifcModels.length),children:(0,Z.jsx)(U.Z,{})})})]}),(0,Z.jsx)(w.Grid,{item:!0,xs:2,className:v.infoRightPannel,children:(0,Z.jsx)(w.Grid,{item:!0,xs:12,children:(0,Z.jsx)(tt,{title:"Exporter IFC",placement:"bottom",className:v.fab,onClick:rn,children:(0,Z.jsx)(V.Z,{})})})}),(0,Z.jsxs)(w.Grid,{item:!0,xs:10,children:[(0,Z.jsx)("div",{id:"viewer-container",style:{position:"absolute",height:"100%",width:"100%",left:"0",top:"0"},onClick:Jt}),(0,Z.jsx)(N(),{ref:b,onDrop:function(e){return zt({files:e,viewer:y})},children:function(e){var t=e.getRootProps,n=e.getInputProps;return(0,Z.jsx)("div",(0,x.Z)((0,x.Z)({},t({className:"dropzone"})),{},{children:(0,Z.jsx)("input",(0,x.Z)((0,x.Z)({},n()),{},{accept:".ifc"}))}))}})]})]}),Bt.alertStatus?(0,Z.jsx)(M.Z,{severity:"success",sx:{position:"fixed",bottom:0,left:0,right:0,width:"100%"},action:(0,Z.jsxs)(w.Grid,{container:!0,spacing:1,children:[(0,Z.jsx)(w.Grid,{item:!0,xs:4,style:{textAlign:"right"},children:(0,Z.jsx)("img",{src:Hn,style:{height:"2em",width:"auto"}})}),(0,Z.jsx)(w.Grid,{item:!0,xs:4,style:{textAlign:"right"},children:(0,Z.jsx)("img",{src:Vn,style:{height:"2em",width:"auto"}})}),(0,Z.jsx)(w.Grid,{item:!0,xs:4,style:{textAlign:"right"},children:(0,Z.jsx)("img",{src:zn,style:{height:"2em",width:"auto"}})})]}),children:"".concat(Bt.alertMessage)}):(0,Z.jsx)(M.Z,{severity:"error",sx:{position:"fixed",bottom:0,left:0,right:0},children:"".concat(Bt.alertMessage)}),(0,Z.jsx)(Mn,{viewer:y,showContextMenu:Be,meshMaterials:Mt,setShowContextMenu:Ae,setShowProperties:De,setShowSpatialStructure:Ze,handleShowMarketplace:Kt,eids:wt,setEids:jt,subsets:Zt,setSubsets:St}),(0,Z.jsx)(w.Backdrop,{style:{zIndex:200,display:"flex",alignItems:"center",alignContent:"center"},open:Bt.loading,children:(0,Z.jsxs)(w.Grid,{container:!0,spacing:2,children:[(0,Z.jsx)(w.Grid,{item:!0,xs:12,justify:"center",style:{textAlign:"center"},children:(0,Z.jsx)(w.CircularProgress,{color:"inherit",style:{color:"white"}})}),(0,Z.jsx)(w.Grid,{item:!0,xs:12,justify:"center",style:{textAlign:"center"},children:(0,Z.jsx)(w.Typography,{gutterBottom:!0,variant:"subtitle1",component:"div",style:{color:"white"},children:"".concat(Bt.loadingMessage)})})]})})]})},er={MenuNavBar:[{text:"",link:"",href:"",icon:""}],MenuSideBarSup:[{text:"BIM Viewer",link:"/",href:"",icon:"dashboard"}],MenuSideBarInf:[{text:"GitHub",link:"",href:"https://github.com/alliance-batiment/BIM-CiQo",icon:"code"}]},tr="./AllianceBatiment_favicon.jpeg",nr="./AllianceBatiment.jpeg",rr="Alliance-Batiment",ar=function(){var e=(0,u.Z)("(prefers-color-scheme: dark)"),t=(0,r.useMemo)((function(){return(0,p.A)({palette:{type:e?"dark":"light",primary:{main:"#ffffff"},secondary:{main:"#ff0000"}}})}),[e]);return(0,Z.jsxs)(h.Z,{theme:t,children:[(0,Z.jsxs)(s(),{children:[(0,Z.jsx)("title",{children:"".concat(rr," | Applications")}),(0,Z.jsx)("link",{rel:"icon",type:"image/png",href:"".concat(tr),sizes:"16x16"})]}),(0,Z.jsx)(l.Router,{history:d,children:(0,Z.jsx)(D,{title:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)("img",{alt:"".concat(rr),src:"".concat(nr),style:{height:"2em",width:"auto"}})})}),menu:er,children:(0,Z.jsxs)(l.Switch,{children:[(0,Z.jsx)(l.Route,{exact:!0,path:"/",component:$n}),(0,Z.jsx)(l.Route,{exact:!0,path:"/ifcrenderer",component:$n}),(0,Z.jsx)(l.Route,{path:"/link-from-tracim",component:$n})]})})})]})},ir=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function or(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o().render((0,Z.jsx)(ar,{}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");ir?(!function(e,t){fetch(e).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):or(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):or(t,e)}))}}()},25671:function(e){function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=25671,e.exports=t}}]);
//# sourceMappingURL=8363.bundle.js.map